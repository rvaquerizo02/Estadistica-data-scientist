<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Capítulo 15 Modelos GLM. Regresión logística y regresión de poisson | Introducción a la Estadística para Científicos de Datos con R</title>
  <meta name="description" content="Libro de introducción a la estadística" />
  <meta name="generator" content="bookdown 0.28 and GitBook 2.6.7" />

  <meta property="og:title" content="Capítulo 15 Modelos GLM. Regresión logística y regresión de poisson | Introducción a la Estadística para Científicos de Datos con R" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Libro de introducción a la estadística" />
  <meta name="github-repo" content="https://github.com/rvaquerizo02/Estadistica-data-scientist" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Capítulo 15 Modelos GLM. Regresión logística y regresión de poisson | Introducción a la Estadística para Científicos de Datos con R" />
  
  <meta name="twitter:description" content="Libro de introducción a la estadística" />
  

<meta name="author" content="Raul Vaquerizo" />


<meta name="date" content="2023-05-16" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="introduccion-diseno-experimentos.html"/>
<link rel="next" href="modelizacion-estadistica.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.24/datatables.js"></script>
<link href="libs/dt-core-1.11.3/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.11.3/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.11.3/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Introducción a la Estadística para Científicos de Datos con R/a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introducción</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#objetivos"><i class="fa fa-check"></i><b>1.1</b> Objetivos</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#entorno-de-trabajo"><i class="fa fa-check"></i><b>1.2</b> Entorno de trabajo</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="datos.html"><a href="datos.html"><i class="fa fa-check"></i><b>2</b> Datos</a>
<ul>
<li class="chapter" data-level="2.1" data-path="datos.html"><a href="datos.html#qué-son-los-datos"><i class="fa fa-check"></i><b>2.1</b> Qué son los datos</a></li>
<li class="chapter" data-level="2.2" data-path="datos.html"><a href="datos.html#tipos-de-datos"><i class="fa fa-check"></i><b>2.2</b> Tipos de datos</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="datos.html"><a href="datos.html#datos-internos"><i class="fa fa-check"></i><b>2.2.1</b> Datos internos</a></li>
<li class="chapter" data-level="2.2.2" data-path="datos.html"><a href="datos.html#datos-externos"><i class="fa fa-check"></i><b>2.2.2</b> Datos externos:</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="datos.html"><a href="datos.html#almacenamiento-de-datos"><i class="fa fa-check"></i><b>2.3</b> Almacenamiento de datos</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="datos.html"><a href="datos.html#sistemas-operacionales"><i class="fa fa-check"></i><b>2.3.1</b> Sistemas operacionales</a></li>
<li class="chapter" data-level="2.3.2" data-path="datos.html"><a href="datos.html#sistemas-informacionales-tradicionales"><i class="fa fa-check"></i><b>2.3.2</b> Sistemas informacionales tradicionales</a></li>
<li class="chapter" data-level="2.3.3" data-path="datos.html"><a href="datos.html#data-lake"><i class="fa fa-check"></i><b>2.3.3</b> Data Lake</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="datos.html"><a href="datos.html#todo-es-álgebra-lineal"><i class="fa fa-check"></i><b>2.4</b> Todo es álgebra lineal</a></li>
<li class="chapter" data-level="2.5" data-path="datos.html"><a href="datos.html#como-se-disponen-los-datos"><i class="fa fa-check"></i><b>2.5</b> Como se disponen los datos</a></li>
<li class="chapter" data-level="2.6" data-path="datos.html"><a href="datos.html#tipos-de-variables"><i class="fa fa-check"></i><b>2.6</b> Tipos de Variables</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="datos.html"><a href="datos.html#variables-cuantitativas"><i class="fa fa-check"></i><b>2.6.1</b> Variables cuantitativas</a></li>
<li class="chapter" data-level="2.6.2" data-path="datos.html"><a href="datos.html#variables-cualitativas.-factores"><i class="fa fa-check"></i><b>2.6.2</b> Variables cualitativas. Factores</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="datos.html"><a href="datos.html#el-rol-de-las-variables-en-los-datos"><i class="fa fa-check"></i><b>2.7</b> El rol de las variables en los datos</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="manejo-de-datos-con-r.html"><a href="manejo-de-datos-con-r.html"><i class="fa fa-check"></i><b>3</b> Manejo de datos con R</a>
<ul>
<li class="chapter" data-level="3.1" data-path="manejo-de-datos-con-r.html"><a href="manejo-de-datos-con-r.html#universo-tidyverse"><i class="fa fa-check"></i><b>3.1</b> Universo tidyverse</a></li>
<li class="chapter" data-level="3.2" data-path="manejo-de-datos-con-r.html"><a href="manejo-de-datos-con-r.html#selección-de-registros"><i class="fa fa-check"></i><b>3.2</b> Selección de registros</a></li>
<li class="chapter" data-level="3.3" data-path="manejo-de-datos-con-r.html"><a href="manejo-de-datos-con-r.html#selección-de-columnas"><i class="fa fa-check"></i><b>3.3</b> Selección de columnas</a></li>
<li class="chapter" data-level="3.4" data-path="manejo-de-datos-con-r.html"><a href="manejo-de-datos-con-r.html#creación-o-actualización-de-variables"><i class="fa fa-check"></i><b>3.4</b> Creación o actualización de variables</a></li>
<li class="chapter" data-level="3.5" data-path="manejo-de-datos-con-r.html"><a href="manejo-de-datos-con-r.html#ordenar-datos"><i class="fa fa-check"></i><b>3.5</b> Ordenar datos</a></li>
<li class="chapter" data-level="3.6" data-path="manejo-de-datos-con-r.html"><a href="manejo-de-datos-con-r.html#sumarizar-valores"><i class="fa fa-check"></i><b>3.6</b> Sumarizar valores</a></li>
<li class="chapter" data-level="3.7" data-path="manejo-de-datos-con-r.html"><a href="manejo-de-datos-con-r.html#combinación-de-acciones"><i class="fa fa-check"></i><b>3.7</b> Combinación de acciones</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="uniones-de-tablas-con-r.html"><a href="uniones-de-tablas-con-r.html"><i class="fa fa-check"></i><b>4</b> Uniones de tablas con R</a>
<ul>
<li class="chapter" data-level="4.1" data-path="uniones-de-tablas-con-r.html"><a href="uniones-de-tablas-con-r.html#uniones-verticales"><i class="fa fa-check"></i><b>4.1</b> Uniones verticales</a></li>
<li class="chapter" data-level="4.2" data-path="uniones-de-tablas-con-r.html"><a href="uniones-de-tablas-con-r.html#uniones-horizontales-o-join"><i class="fa fa-check"></i><b>4.2</b> Uniones horizontales o <em>join</em></a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="uniones-de-tablas-con-r.html"><a href="uniones-de-tablas-con-r.html#inner-join"><i class="fa fa-check"></i><b>4.2.1</b> Inner join</a></li>
<li class="chapter" data-level="4.2.2" data-path="uniones-de-tablas-con-r.html"><a href="uniones-de-tablas-con-r.html#left-join"><i class="fa fa-check"></i><b>4.2.2</b> Left join</a></li>
<li class="chapter" data-level="4.2.3" data-path="uniones-de-tablas-con-r.html"><a href="uniones-de-tablas-con-r.html#anti-join"><i class="fa fa-check"></i><b>4.2.3</b> Anti join</a></li>
<li class="chapter" data-level="4.2.4" data-path="uniones-de-tablas-con-r.html"><a href="uniones-de-tablas-con-r.html#librería-sqldf"><i class="fa fa-check"></i><b>4.2.4</b> Librería sqldf</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="uniones-de-tablas-con-r.html"><a href="uniones-de-tablas-con-r.html#duplicidades-en-las-uniones-de-tablas"><i class="fa fa-check"></i><b>4.3</b> Duplicidades en las uniones de tablas</a></li>
<li class="chapter" data-level="4.4" data-path="uniones-de-tablas-con-r.html"><a href="uniones-de-tablas-con-r.html#referencias"><i class="fa fa-check"></i><b>4.4</b> Referencias</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="basicos-ggplot.html"><a href="basicos-ggplot.html"><i class="fa fa-check"></i><b>5</b> Representación gráfica básica con ggplot</a>
<ul>
<li class="chapter" data-level="5.1" data-path="basicos-ggplot.html"><a href="basicos-ggplot.html#histogramas"><i class="fa fa-check"></i><b>5.1</b> Histogramas</a></li>
<li class="chapter" data-level="5.2" data-path="basicos-ggplot.html"><a href="basicos-ggplot.html#gráficos-de-densidad"><i class="fa fa-check"></i><b>5.2</b> Gráficos de densidad</a></li>
<li class="chapter" data-level="5.3" data-path="basicos-ggplot.html"><a href="basicos-ggplot.html#gráficos-de-caja-boxplot"><i class="fa fa-check"></i><b>5.3</b> Gráficos de caja (boxplot)</a></li>
<li class="chapter" data-level="5.4" data-path="basicos-ggplot.html"><a href="basicos-ggplot.html#gráficos-de-tarta"><i class="fa fa-check"></i><b>5.4</b> Gráficos de tarta</a></li>
<li class="chapter" data-level="5.5" data-path="basicos-ggplot.html"><a href="basicos-ggplot.html#gráficos-de-barras"><i class="fa fa-check"></i><b>5.5</b> Gráficos de barras</a></li>
<li class="chapter" data-level="5.6" data-path="basicos-ggplot.html"><a href="basicos-ggplot.html#gráficos-de-líneas"><i class="fa fa-check"></i><b>5.6</b> Gráficos de líneas</a></li>
<li class="chapter" data-level="5.7" data-path="basicos-ggplot.html"><a href="basicos-ggplot.html#gráfico-de-dispersión"><i class="fa fa-check"></i><b>5.7</b> Gráfico de dispersión</a></li>
<li class="chapter" data-level="5.8" data-path="basicos-ggplot.html"><a href="basicos-ggplot.html#múltiples-gráficos-con-gridextra"><i class="fa fa-check"></i><b>5.8</b> Múltiples gráficos con gridExtra</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="descripcion-numerica-variables.html"><a href="descripcion-numerica-variables.html"><i class="fa fa-check"></i><b>6</b> Descripción numérica de variables</a>
<ul>
<li class="chapter" data-level="6.1" data-path="descripcion-numerica-variables.html"><a href="descripcion-numerica-variables.html#transformar-datos-en-información"><i class="fa fa-check"></i><b>6.1</b> Transformar datos en información</a></li>
<li class="chapter" data-level="6.2" data-path="descripcion-numerica-variables.html"><a href="descripcion-numerica-variables.html#caso-práctico.-campaña-de-venta-cruzada"><i class="fa fa-check"></i><b>6.2</b> Caso práctico. Campaña de venta cruzada</a></li>
<li class="chapter" data-level="6.3" data-path="descripcion-numerica-variables.html"><a href="descripcion-numerica-variables.html#el-rol-de-las-variables-en-el-conjunto-de-datos"><i class="fa fa-check"></i><b>6.3</b> El rol de las variables en el conjunto de datos</a></li>
<li class="chapter" data-level="6.4" data-path="descripcion-numerica-variables.html"><a href="descripcion-numerica-variables.html#análisis-descriptivos-de-los-datos"><i class="fa fa-check"></i><b>6.4</b> Análisis descriptivos de los datos</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="descripcion-numerica-variables.html"><a href="descripcion-numerica-variables.html#descritivos-en-variables-cualitativas-factores"><i class="fa fa-check"></i><b>6.4.1</b> Descritivos en variables cualitativas (factores)</a></li>
<li class="chapter" data-level="6.4.2" data-path="descripcion-numerica-variables.html"><a href="descripcion-numerica-variables.html#descritivos-en-variables-cuantitativas"><i class="fa fa-check"></i><b>6.4.2</b> Descritivos en variables cuantitativas</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="descripcion-grafica-datos.html"><a href="descripcion-grafica-datos.html"><i class="fa fa-check"></i><b>7</b> Descripción gráfica de datos</a>
<ul>
<li class="chapter" data-level="7.1" data-path="descripcion-grafica-datos.html"><a href="descripcion-grafica-datos.html#descripción-gráfica-de-factores"><i class="fa fa-check"></i><b>7.1</b> Descripción gráfica de factores</a></li>
<li class="chapter" data-level="7.2" data-path="descripcion-grafica-datos.html"><a href="descripcion-grafica-datos.html#descripción-gráfica-de-variables-numéricas"><i class="fa fa-check"></i><b>7.2</b> Descripción gráfica de variables numéricas</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="problemas-datos.html"><a href="problemas-datos.html"><i class="fa fa-check"></i><b>8</b> Problemas con los datos</a>
<ul>
<li class="chapter" data-level="8.1" data-path="problemas-datos.html"><a href="problemas-datos.html#problemática-con-factores"><i class="fa fa-check"></i><b>8.1</b> Problemática con factores</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="problemas-datos.html"><a href="problemas-datos.html#factores-con-niveles-de-pocos-registros"><i class="fa fa-check"></i><b>8.1.1</b> Factores con niveles de pocos registros</a></li>
<li class="chapter" data-level="8.1.2" data-path="problemas-datos.html"><a href="problemas-datos.html#factores-que-aparecen-como-variables-numéricas"><i class="fa fa-check"></i><b>8.1.2</b> Factores que aparecen como variables numéricas</a></li>
<li class="chapter" data-level="8.1.3" data-path="problemas-datos.html"><a href="problemas-datos.html#factores-con-un-gran-número-de-niveles"><i class="fa fa-check"></i><b>8.1.3</b> Factores con un gran número de niveles</a></li>
<li class="chapter" data-level="8.1.4" data-path="problemas-datos.html"><a href="problemas-datos.html#factores-con-valores-perdidos"><i class="fa fa-check"></i><b>8.1.4</b> Factores con valores perdidos</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="problemas-datos.html"><a href="problemas-datos.html#problemas-con-variables-numéricas"><i class="fa fa-check"></i><b>8.2</b> Problemas con variables numéricas</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="problemas-datos.html"><a href="problemas-datos.html#valores-modales"><i class="fa fa-check"></i><b>8.2.1</b> Valores modales</a></li>
<li class="chapter" data-level="8.2.2" data-path="problemas-datos.html"><a href="problemas-datos.html#valores-atípicos"><i class="fa fa-check"></i><b>8.2.2</b> Valores atípicos</a></li>
<li class="chapter" data-level="8.2.3" data-path="problemas-datos.html"><a href="problemas-datos.html#variables-numéricas-como-factores"><i class="fa fa-check"></i><b>8.2.3</b> Variables numéricas como factores</a></li>
<li class="chapter" data-level="8.2.4" data-path="problemas-datos.html"><a href="problemas-datos.html#valores-perdidos-en-variables-numéricas"><i class="fa fa-check"></i><b>8.2.4</b> Valores perdidos en variables numéricas</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="analisis-exploratorio-datos-EDA.html"><a href="analisis-exploratorio-datos-EDA.html"><i class="fa fa-check"></i><b>9</b> Análisis Exploratorio de Datos. EDA</a></li>
<li class="chapter" data-level="10" data-path="probabilidad-distribuciones.html"><a href="probabilidad-distribuciones.html"><i class="fa fa-check"></i><b>10</b> Probabilidad y distribuciones</a>
<ul>
<li class="chapter" data-level="10.1" data-path="probabilidad-distribuciones.html"><a href="probabilidad-distribuciones.html#conceptos-básicos-de-probabilidad"><i class="fa fa-check"></i><b>10.1</b> Conceptos básicos de probabilidad</a></li>
<li class="chapter" data-level="10.2" data-path="probabilidad-distribuciones.html"><a href="probabilidad-distribuciones.html#distribución-de-un-evento"><i class="fa fa-check"></i><b>10.2</b> Distribución de un evento</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="probabilidad-distribuciones.html"><a href="probabilidad-distribuciones.html#distribuciones-conocidas"><i class="fa fa-check"></i><b>10.2.1</b> Distribuciones conocidas</a></li>
<li class="chapter" data-level="10.2.2" data-path="probabilidad-distribuciones.html"><a href="probabilidad-distribuciones.html#obtención-de-probabilidades-con-r"><i class="fa fa-check"></i><b>10.2.2</b> Obtención de probabilidades con R</a></li>
<li class="chapter" data-level="10.2.3" data-path="probabilidad-distribuciones.html"><a href="probabilidad-distribuciones.html#generación-de-números-aleatorios-con-r"><i class="fa fa-check"></i><b>10.2.3</b> Generación de números aleatorios con R</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="probabilidad-distribuciones.html"><a href="probabilidad-distribuciones.html#distribuciones-discretas"><i class="fa fa-check"></i><b>10.3</b> Distribuciones discretas</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="probabilidad-distribuciones.html"><a href="probabilidad-distribuciones.html#distribución-de-bernoulli"><i class="fa fa-check"></i><b>10.3.1</b> Distribución de Bernoulli</a></li>
<li class="chapter" data-level="10.3.2" data-path="probabilidad-distribuciones.html"><a href="probabilidad-distribuciones.html#distribución-binomial"><i class="fa fa-check"></i><b>10.3.2</b> Distribución binomial</a></li>
<li class="chapter" data-level="10.3.3" data-path="probabilidad-distribuciones.html"><a href="probabilidad-distribuciones.html#distribución-de-poisson"><i class="fa fa-check"></i><b>10.3.3</b> Distribución de Poisson</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="probabilidad-distribuciones.html"><a href="probabilidad-distribuciones.html#distribuciones-continuas"><i class="fa fa-check"></i><b>10.4</b> Distribuciones continuas</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="probabilidad-distribuciones.html"><a href="probabilidad-distribuciones.html#distribución-uniforme"><i class="fa fa-check"></i><b>10.4.1</b> Distribución uniforme</a></li>
<li class="chapter" data-level="10.4.2" data-path="probabilidad-distribuciones.html"><a href="probabilidad-distribuciones.html#distribución-normal"><i class="fa fa-check"></i><b>10.4.2</b> Distribución normal</a></li>
<li class="chapter" data-level="10.4.3" data-path="probabilidad-distribuciones.html"><a href="probabilidad-distribuciones.html#distribución-gamma"><i class="fa fa-check"></i><b>10.4.3</b> Distribución gamma</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="analisis-bivariable.html"><a href="analisis-bivariable.html"><i class="fa fa-check"></i><b>11</b> Análisis bivariable</a>
<ul>
<li class="chapter" data-level="11.1" data-path="analisis-bivariable.html"><a href="analisis-bivariable.html#variable-numérica-frente-a-variable-numérica"><i class="fa fa-check"></i><b>11.1</b> Variable numérica frente a variable numérica</a></li>
<li class="chapter" data-level="11.2" data-path="analisis-bivariable.html"><a href="analisis-bivariable.html#factores-frente-a-variables-numéricas"><i class="fa fa-check"></i><b>11.2</b> Factores frente a variables numéricas</a></li>
<li class="chapter" data-level="11.3" data-path="analisis-bivariable.html"><a href="analisis-bivariable.html#factores-frente-a-factores"><i class="fa fa-check"></i><b>11.3</b> Factores frente a factores</a></li>
<li class="chapter" data-level="11.4" data-path="analisis-bivariable.html"><a href="analisis-bivariable.html#propuesta-de-análisis-gráfico-para-el-análisis-bivariable"><i class="fa fa-check"></i><b>11.4</b> Propuesta de análisis gráfico para el análisis bivariable</a></li>
<li class="chapter" data-level="11.5" data-path="analisis-bivariable.html"><a href="analisis-bivariable.html#correlación-entre-factores.-la-v-de-cramer"><i class="fa fa-check"></i><b>11.5</b> Correlación entre factores. La V de Cramer</a></li>
<li class="chapter" data-level="11.6" data-path="analisis-bivariable.html"><a href="analisis-bivariable.html#agrupación-de-variables-cuantitativas"><i class="fa fa-check"></i><b>11.6</b> Agrupación de variables cuantitativas</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="muestreo-inferencia.html"><a href="muestreo-inferencia.html"><i class="fa fa-check"></i><b>12</b> Muestreo e inferencia estadística</a>
<ul>
<li class="chapter" data-level="12.1" data-path="muestreo-inferencia.html"><a href="muestreo-inferencia.html#muestreo"><i class="fa fa-check"></i><b>12.1</b> Muestreo</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="muestreo-inferencia.html"><a href="muestreo-inferencia.html#muestreo-aleatorio-simple"><i class="fa fa-check"></i><b>12.1.1</b> Muestreo aleatorio simple</a></li>
<li class="chapter" data-level="12.1.2" data-path="muestreo-inferencia.html"><a href="muestreo-inferencia.html#muestreo-aleatorio-estratificado"><i class="fa fa-check"></i><b>12.1.2</b> Muestreo aleatorio estratificado</a></li>
<li class="chapter" data-level="12.1.3" data-path="muestreo-inferencia.html"><a href="muestreo-inferencia.html#muestreo-por-conglomerados"><i class="fa fa-check"></i><b>12.1.3</b> Muestreo por conglomerados</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="muestreo-inferencia.html"><a href="muestreo-inferencia.html#inferencia-estadística"><i class="fa fa-check"></i><b>12.2</b> Inferencia estadística</a></li>
<li class="chapter" data-level="12.3" data-path="muestreo-inferencia.html"><a href="muestreo-inferencia.html#estimación-de-parámetros"><i class="fa fa-check"></i><b>12.3</b> Estimación de parámetros</a></li>
<li class="chapter" data-level="12.4" data-path="muestreo-inferencia.html"><a href="muestreo-inferencia.html#intervalos-de-confianza"><i class="fa fa-check"></i><b>12.4</b> Intervalos de confianza</a></li>
<li class="chapter" data-level="12.5" data-path="muestreo-inferencia.html"><a href="muestreo-inferencia.html#contrastes-de-hipótesis"><i class="fa fa-check"></i><b>12.5</b> Contrastes de hipótesis</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="regresion-lineal.html"><a href="regresion-lineal.html"><i class="fa fa-check"></i><b>13</b> Regresión lineal</a>
<ul>
<li class="chapter" data-level="13.1" data-path="regresion-lineal.html"><a href="regresion-lineal.html#modelo-de-regresión-lineal-simple"><i class="fa fa-check"></i><b>13.1</b> Modelo de regresión lineal simple</a></li>
<li class="chapter" data-level="13.2" data-path="regresion-lineal.html"><a href="regresion-lineal.html#el-coeficiente-de-determinación-o-r2"><i class="fa fa-check"></i><b>13.2</b> El coeficiente de determinación o <span class="math inline">\(R^2\)</span></a></li>
<li class="chapter" data-level="13.3" data-path="regresion-lineal.html"><a href="regresion-lineal.html#transformaciones-de-variables"><i class="fa fa-check"></i><b>13.3</b> Transformaciones de variables</a></li>
<li class="chapter" data-level="13.4" data-path="regresion-lineal.html"><a href="regresion-lineal.html#tramificación-de-variables-en-modelos-lineales"><i class="fa fa-check"></i><b>13.4</b> Tramificación de variables en modelos lineales</a></li>
<li class="chapter" data-level="13.5" data-path="regresion-lineal.html"><a href="regresion-lineal.html#factores-en-modelos-de-regresión"><i class="fa fa-check"></i><b>13.5</b> Factores en modelos de regresión</a></li>
<li class="chapter" data-level="13.6" data-path="regresion-lineal.html"><a href="regresion-lineal.html#modelo-de-regresión-lineal-múltiple"><i class="fa fa-check"></i><b>13.6</b> Modelo de regresión lineal múltiple</a></li>
<li class="chapter" data-level="13.7" data-path="regresion-lineal.html"><a href="regresion-lineal.html#métodos-de-selección-de-variables"><i class="fa fa-check"></i><b>13.7</b> Métodos de selección de variables</a>
<ul>
<li class="chapter" data-level="13.7.1" data-path="regresion-lineal.html"><a href="regresion-lineal.html#método-fordward"><i class="fa fa-check"></i><b>13.7.1</b> Método fordward</a></li>
<li class="chapter" data-level="13.7.2" data-path="regresion-lineal.html"><a href="regresion-lineal.html#método-backward"><i class="fa fa-check"></i><b>13.7.2</b> Método backward</a></li>
<li class="chapter" data-level="13.7.3" data-path="regresion-lineal.html"><a href="regresion-lineal.html#método-stepwise"><i class="fa fa-check"></i><b>13.7.3</b> Método stepwise</a></li>
</ul></li>
<li class="chapter" data-level="13.8" data-path="regresion-lineal.html"><a href="regresion-lineal.html#el-principio-de-parsimonia"><i class="fa fa-check"></i><b>13.8</b> El principio de parsimonia</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="introduccion-diseno-experimentos.html"><a href="introduccion-diseno-experimentos.html"><i class="fa fa-check"></i><b>14</b> Introducción al diseño de experimentos</a>
<ul>
<li class="chapter" data-level="14.1" data-path="introduccion-diseno-experimentos.html"><a href="introduccion-diseno-experimentos.html#fundamentos-del-diseño-experimental"><i class="fa fa-check"></i><b>14.1</b> Fundamentos del diseño experimental</a></li>
<li class="chapter" data-level="14.2" data-path="introduccion-diseno-experimentos.html"><a href="introduccion-diseno-experimentos.html#fuentes-de-variabilidad"><i class="fa fa-check"></i><b>14.2</b> Fuentes de variabilidad</a></li>
<li class="chapter" data-level="14.3" data-path="introduccion-diseno-experimentos.html"><a href="introduccion-diseno-experimentos.html#planificación"><i class="fa fa-check"></i><b>14.3</b> Planificación</a></li>
<li class="chapter" data-level="14.4" data-path="introduccion-diseno-experimentos.html"><a href="introduccion-diseno-experimentos.html#bloquear-y-aleatorizar-factores"><i class="fa fa-check"></i><b>14.4</b> Bloquear y aleatorizar factores</a></li>
<li class="chapter" data-level="14.5" data-path="introduccion-diseno-experimentos.html"><a href="introduccion-diseno-experimentos.html#diseños-factoriales"><i class="fa fa-check"></i><b>14.5</b> Diseños factoriales</a>
<ul>
<li class="chapter" data-level="14.5.1" data-path="introduccion-diseno-experimentos.html"><a href="introduccion-diseno-experimentos.html#modelo-unifactorial.-ab-testing"><i class="fa fa-check"></i><b>14.5.1</b> Modelo unifactorial. A/B testing</a></li>
</ul></li>
<li class="chapter" data-level="14.6" data-path="introduccion-diseno-experimentos.html"><a href="introduccion-diseno-experimentos.html#modelos-bifactoriales.-interacciones-entre-variables"><i class="fa fa-check"></i><b>14.6</b> Modelos bifactoriales. Interacciones entre variables</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="modelos-GLM.html"><a href="modelos-GLM.html"><i class="fa fa-check"></i><b>15</b> Modelos GLM. Regresión logística y regresión de poisson</a>
<ul>
<li class="chapter" data-level="15.1" data-path="modelos-GLM.html"><a href="modelos-GLM.html#motivación-de-los-modelos-glm"><i class="fa fa-check"></i><b>15.1</b> Motivación de los modelos GLM</a></li>
<li class="chapter" data-level="15.2" data-path="modelos-GLM.html"><a href="modelos-GLM.html#la-función-de-enlace-en-los-modelos-glm"><i class="fa fa-check"></i><b>15.2</b> La función de enlace en los modelos GLM</a></li>
<li class="chapter" data-level="15.3" data-path="modelos-GLM.html"><a href="modelos-GLM.html#regresión-logística"><i class="fa fa-check"></i><b>15.3</b> Regresión logística</a></li>
<li class="chapter" data-level="15.4" data-path="modelos-GLM.html"><a href="modelos-GLM.html#regresión-de-poisson"><i class="fa fa-check"></i><b>15.4</b> Regresión de poisson</a></li>
<li class="chapter" data-level="15.5" data-path="modelos-GLM.html"><a href="modelos-GLM.html#los-glm-y-el-concepto-microsegmento"><i class="fa fa-check"></i><b>15.5</b> Los GLM y el concepto microsegmento</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="modelizacion-estadistica.html"><a href="modelizacion-estadistica.html"><i class="fa fa-check"></i><b>16</b> Modelización estadística. Conociendo los datos</a>
<ul>
<li class="chapter" data-level="16.1" data-path="modelizacion-estadistica.html"><a href="modelizacion-estadistica.html#establecer-un-método-para-la-modelización-estadística"><i class="fa fa-check"></i><b>16.1</b> Establecer un método para la modelización estadística</a></li>
<li class="chapter" data-level="16.2" data-path="modelizacion-estadistica.html"><a href="modelizacion-estadistica.html#un-método-de-modelización-estadística"><i class="fa fa-check"></i><b>16.2</b> Un método de modelización estadística</a></li>
<li class="chapter" data-level="16.3" data-path="modelizacion-estadistica.html"><a href="modelizacion-estadistica.html#conocimiento-de-los-datos"><i class="fa fa-check"></i><b>16.3</b> Conocimiento de los datos</a>
<ul>
<li class="chapter" data-level="16.3.1" data-path="modelizacion-estadistica.html"><a href="modelizacion-estadistica.html#muestreo.-datos-de-entrenamiento-datos-de-validación-datos-de-test-y-prueba-ciega."><i class="fa fa-check"></i><b>16.3.1</b> Muestreo. Datos de entrenamiento, datos de validación, datos de test y prueba ciega.</a></li>
<li class="chapter" data-level="16.3.2" data-path="modelizacion-estadistica.html"><a href="modelizacion-estadistica.html#aproximación-inicial-a-los-datos"><i class="fa fa-check"></i><b>16.3.2</b> Aproximación inicial a los datos</a></li>
<li class="chapter" data-level="16.3.3" data-path="modelizacion-estadistica.html"><a href="modelizacion-estadistica.html#clasificación-de-factores"><i class="fa fa-check"></i><b>16.3.3</b> Clasificación de factores</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="modelizacion-estadistica.html"><a href="modelizacion-estadistica.html#el-código-de-reclasificación-de-factores"><i class="fa fa-check"></i><b>16.4</b> El código de reclasificación de factores</a></li>
<li class="chapter" data-level="16.5" data-path="modelizacion-estadistica.html"><a href="modelizacion-estadistica.html#análisis-de-interacciones"><i class="fa fa-check"></i><b>16.5</b> Análisis de interacciones</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introducción a la Estadística para Científicos de Datos con R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="modelos-GLM" class="section level1 hasAnchor" number="15">
<h1><span class="header-section-number">Capítulo 15</span> Modelos GLM. Regresión logística y regresión de poisson<a href="modelos-GLM.html#modelos-GLM" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="motivación-de-los-modelos-glm" class="section level2 hasAnchor" number="15.1">
<h2><span class="header-section-number">15.1</span> Motivación de los modelos GLM<a href="modelos-GLM.html#motivación-de-los-modelos-glm" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Hasta el momento se han planteado los siguientes modelos.</p>
<ul>
<li>Modelo de regresión lineal</li>
<li>Modelos factoriales en diseño de experimentos</li>
</ul>
<p>Para ambos modelos la variable respuesta ha de ser cuantitativa y distribuida normalmente, pero en el capítulo 10 se vio la siguiente figura.</p>
<p><img src="imagenes/tipo_analisis.png" /></p>
<p>La respuesta normal o gaussiana aparece, pero existen otro tipo de situaciones a las que se enfrenta el científico de datos donde <strong>el evento a estudiar no se distribuye normalmente</strong>. Sin ir mas lejos, en el ejercicio que está sirviendo de hilo conductor en el ensayo, una aseguradora española que opera en múltiples ramos quiere ofrecer seguro de automóviles a sus clientes del ramo de salud. Para ello se realizó un cuestionario a los clientes de forma que se marcó quienes de ellos estarían interesados en el producto de automóviles y quienes no. La variable de interés es si o no lo que plantea una clasificación binomial. <strong>¿Qué sucede si se modeliza eventos si/no mediante un modelo de regresión lineal?</strong> Siguiendo el propio ejemplo de trabajo al que se hace permanentemente referencia.</p>
<div class="sourceCode" id="cb413"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb413-1"><a href="modelos-GLM.html#cb413-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb413-2"><a href="modelos-GLM.html#cb413-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DT)</span>
<span id="cb413-3"><a href="modelos-GLM.html#cb413-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb413-4"><a href="modelos-GLM.html#cb413-4" aria-hidden="true" tabindex="-1"></a>train <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;./data/train.csv&quot;</span>)</span>
<span id="cb413-5"><a href="modelos-GLM.html#cb413-5" aria-hidden="true" tabindex="-1"></a><span class="fu">datatable</span>(<span class="fu">head</span>(train,<span class="dv">5</span>))</span></code></pre></div>
<div id="htmlwidget-43df93850aad8c57b5e4" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-43df93850aad8c57b5e4">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5"],[1,2,3,4,5],["Male","Male","Male","Male","Female"],[44,76,47,21,29],[1,1,1,1,1],[28,3,28,11,41],[0,0,0,1,1],["&gt; 2 Years","1-2 Year","&gt; 2 Years","&lt; 1 Year","&lt; 1 Year"],["Yes","No","Yes","No","No"],[40454,33536,38294,28619,27496],[26,26,26,152,152],[217,183,27,203,39],[1,0,1,0,0]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>id<\/th>\n      <th>Gender<\/th>\n      <th>Age<\/th>\n      <th>Driving_License<\/th>\n      <th>Region_Code<\/th>\n      <th>Previously_Insured<\/th>\n      <th>Vehicle_Age<\/th>\n      <th>Vehicle_Damage<\/th>\n      <th>Annual_Premium<\/th>\n      <th>Policy_Sales_Channel<\/th>\n      <th>Vintage<\/th>\n      <th>Response<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,3,4,5,6,9,10,11,12]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<p>Código conocido para importar los datos y mostrar la cabecera de los mismos, a continuación se realiza un modelo de regresión lineal sobre una muestra aleatoria del conjunto de datos de partida de 1000 observaciones donde la variable <code>Response</code> se pone en función de la prima anual <code>Annual_Premium</code>.</p>
<div class="sourceCode" id="cb414"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb414-1"><a href="modelos-GLM.html#cb414-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb414-2"><a href="modelos-GLM.html#cb414-2" aria-hidden="true" tabindex="-1"></a>muestra <span class="ot">&lt;-</span> train <span class="sc">%&gt;%</span> <span class="fu">sample_n</span>(<span class="dv">1000</span>)</span>
<span id="cb414-3"><a href="modelos-GLM.html#cb414-3" aria-hidden="true" tabindex="-1"></a>modelo.prueba <span class="ot">&lt;-</span> <span class="fu">lm</span>(muestra<span class="sc">$</span>Response <span class="sc">~</span> muestra<span class="sc">$</span>Annual_Premium)</span></code></pre></div>
<p>Se grafica el resultado del modelo tras la realización del scoring sobre el propio conjunto de datos empleado para realizar el modelo.</p>
<div class="sourceCode" id="cb415"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb415-1"><a href="modelos-GLM.html#cb415-1" aria-hidden="true" tabindex="-1"></a>muestra<span class="sc">$</span>prediccion <span class="ot">&lt;-</span> <span class="fu">predict</span>(modelo.prueba, muestra)</span>
<span id="cb415-2"><a href="modelos-GLM.html#cb415-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb415-3"><a href="modelos-GLM.html#cb415-3" aria-hidden="true" tabindex="-1"></a>muestra <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>Annual_Premium, <span class="at">y=</span>Response)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb415-4"><a href="modelos-GLM.html#cb415-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x=</span>Annual_Premium,prediccion), <span class="at">color=</span><span class="st">&quot;#E30606&quot;</span>)</span></code></pre></div>
<p><img src="estadistica-data-scientist_files/figure-html/unnamed-chunk-314-1.png" width="672" /></p>
<p>Se puede observar que una recta de regresión no tiene mucho sentido, es una recta que está entre el 0 y el 1, no sirve este modelo para modelizar una variable que toma valores de esta forma. Un paso más allá, llevando este caso al extremo se modeliza una función de probabilidad de un evento de la forma <span class="math inline">\(P(x) = \frac{1}{1 + exp(f(x))}\)</span></p>
<div class="sourceCode" id="cb416"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb416-1"><a href="modelos-GLM.html#cb416-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Observaciones</span></span>
<span id="cb416-2"><a href="modelos-GLM.html#cb416-2" aria-hidden="true" tabindex="-1"></a>num <span class="ot">=</span> <span class="dv">1000</span></span>
<span id="cb416-3"><a href="modelos-GLM.html#cb416-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">rnorm</span>(num)</span></code></pre></div>
<p>La variable independiente x se distribuye normalmente. Ahora se calcula una probabilidad con la función de probabilidad antes citada para <span class="math inline">\(f(x)=-5 + 2.5*x\)</span> (por asignar unos parámetros). Esa probabilidad se pasa a valores 0 y 1 mediante una generación de números aleatorios de una binomial.</p>
<div class="sourceCode" id="cb417"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb417-1"><a href="modelos-GLM.html#cb417-1" aria-hidden="true" tabindex="-1"></a>p<span class="ot">=</span><span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span><span class="fu">exp</span>(<span class="sc">-</span>(<span class="sc">-</span><span class="dv">5</span> <span class="sc">+</span> <span class="fl">2.5</span><span class="sc">*</span>x)))</span>
<span id="cb417-2"><a href="modelos-GLM.html#cb417-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Generación de 0/1 aleatorios en función de p</span></span>
<span id="cb417-3"><a href="modelos-GLM.html#cb417-3" aria-hidden="true" tabindex="-1"></a>y<span class="ot">=</span><span class="fu">rbinom</span>(num,<span class="dv">1</span>,p)</span>
<span id="cb417-4"><a href="modelos-GLM.html#cb417-4" aria-hidden="true" tabindex="-1"></a>datos_binomial <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="fu">cbind</span>(x,y))</span></code></pre></div>
<p>En este punto se dispone de un conjunto de datos donde la variable dependiente es una distribución binomial función de una variable independiente que se distribuye normalmente. Se insiste en la importancia de generar este tipo de variables no solo para entender como se comportan funciones, también es útil para crear sistemas complejos. Con el conjunto de datos generado artificialmente se realiza un modelo.</p>
<div class="sourceCode" id="cb418"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb418-1"><a href="modelos-GLM.html#cb418-1" aria-hidden="true" tabindex="-1"></a>modelo.prueba2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>datos_binomial, y<span class="sc">~</span>x)</span>
<span id="cb418-2"><a href="modelos-GLM.html#cb418-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb418-3"><a href="modelos-GLM.html#cb418-3" aria-hidden="true" tabindex="-1"></a>prediccion <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x=</span>datos_binomial<span class="sc">$</span>x, <span class="at">y =</span> <span class="fu">predict</span>(modelo.prueba2, datos_binomial))</span>
<span id="cb418-4"><a href="modelos-GLM.html#cb418-4" aria-hidden="true" tabindex="-1"></a>                                                         </span>
<span id="cb418-5"><a href="modelos-GLM.html#cb418-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>datos_binomial, <span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>y)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb418-6"><a href="modelos-GLM.html#cb418-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> prediccion, <span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>y), <span class="at">color=</span><span class="st">&quot;red&quot;</span>) <span class="sc">+</span> </span>
<span id="cb418-7"><a href="modelos-GLM.html#cb418-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Regresión lineal sobre datos binomiales&quot;</span>)</span></code></pre></div>
<p><img src="estadistica-data-scientist_files/figure-html/unnamed-chunk-317-1.png" width="672" /></p>
<p>En este caso el modelo de regresión lineal puede obtener números inferiores a 0 que no tienen sentido, es claro que a medida que aumenta x aumenta la probabilidad de y = 1. Además,como se señaló en la figura con la que se iniciaba el capítulo los problemas a los que se enfrenta un científico de datos no son solamente clasificaciones binomiales, pueden seguir una distribución de Poisson si se están contando elementos en un espacio de tiempo o una distribución Gamma si se están modelizando importes (por ejemplo). En estas situaciones los modelos lineales tal y como se han trabajado hasta el momento no sirven. Es necesario añadir algún elemento, alguna <strong>transformación o función</strong> que permita emplear modelos lineales con este tipo de distribuciones y por ello aparecen los <strong>Modelos Lineales Generalizados</strong> GLM por sus siglas en ingles. Son modelos lineales que permiten que la variable dependiente no tenga cambios aditivos, es decir, que la variable dependiente no se distribuya normalmente.</p>
</div>
<div id="la-función-de-enlace-en-los-modelos-glm" class="section level2 hasAnchor" number="15.2">
<h2><span class="header-section-number">15.2</span> La función de enlace en los modelos GLM<a href="modelos-GLM.html#la-función-de-enlace-en-los-modelos-glm" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Como en todo modelo estadístico se tiene una componente aleatoria que hay predecir/explicar que ahora no se distribuye normalmente y se dispone de otro componente que, sistemáticamente, <strong>predice/describe</strong> esa componente aleatoria. Los GLM añaden al modelo lineal una función de enlace a los datos que nos permite relacionar los modelos lineales con otro tipo de distribuciones mediante una función de la media. Para entender mejor en que consiste la función de enlace hay que volver al modelo lineal donde se indicaba que era una variación aditiva de medias por lo que su función de enlace es la propia media. En una distribución binomial la media es una proporción <span class="math inline">\(p\)</span> pero se ve en el ejemplo anterior que el modelo no arroja el dato esperado, sin embargo, si se modeliza <span class="math inline">\(log(\frac{p}{1-p})\)</span> para esos datos artificiales creados con anterioridad ¿qué sucede?</p>
<div class="sourceCode" id="cb419"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb419-1"><a href="modelos-GLM.html#cb419-1" aria-hidden="true" tabindex="-1"></a>modelo.prueba2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>datos_binomial, <span class="fu">log</span>(p<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>p))<span class="sc">~</span>x)</span>
<span id="cb419-2"><a href="modelos-GLM.html#cb419-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo.prueba2)</span></code></pre></div>
<pre><code>## Warning in summary.lm(modelo.prueba2): essentially perfect fit: summary may be unreliable</code></pre>
<pre><code>## 
## Call:
## lm(formula = log(p/(1 - p)) ~ x, data = datos_binomial)
## 
## Residuals:
##        Min         1Q     Median         3Q        Max 
## -1.193e-14 -3.040e-16  6.000e-18  2.190e-16  7.750e-14 
## 
## Coefficients:
##               Estimate Std. Error    t value Pr(&gt;|t|)    
## (Intercept) -5.000e+00  7.971e-17 -6.273e+16   &lt;2e-16 ***
## x            2.500e+00  7.712e-17  3.242e+16   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.52e-15 on 998 degrees of freedom
## Multiple R-squared:      1,  Adjusted R-squared:      1 
## F-statistic: 1.051e+33 on 1 and 998 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb422"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb422-1"><a href="modelos-GLM.html#cb422-1" aria-hidden="true" tabindex="-1"></a>prediccion <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x=</span>datos_binomial<span class="sc">$</span>x, <span class="at">y =</span> <span class="fu">predict</span>(modelo.prueba2, datos_binomial))</span></code></pre></div>
<p>Se crea un modelo perfecto (así lo advierte R) con los parámetros y la función que han generado los datos. En este punto se recuerda la necesidad de deshacer la transformación sobre la variable dependiente, asunto tratado en el tema referente a la regresión lineal.</p>
<div class="sourceCode" id="cb423"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb423-1"><a href="modelos-GLM.html#cb423-1" aria-hidden="true" tabindex="-1"></a>prediccion<span class="sc">$</span>y <span class="ot">&lt;-</span> <span class="fu">exp</span>(prediccion<span class="sc">$</span>y)<span class="sc">/</span>(<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(prediccion<span class="sc">$</span>y))</span>
<span id="cb423-2"><a href="modelos-GLM.html#cb423-2" aria-hidden="true" tabindex="-1"></a>                                                         </span>
<span id="cb423-3"><a href="modelos-GLM.html#cb423-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>datos_binomial, <span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>y)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb423-4"><a href="modelos-GLM.html#cb423-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> prediccion, <span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>y), <span class="at">color=</span><span class="st">&quot;red&quot;</span>) <span class="sc">+</span> </span>
<span id="cb423-5"><a href="modelos-GLM.html#cb423-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Regresión lineal sobre datos binomiales&quot;</span>)</span></code></pre></div>
<p><img src="estadistica-data-scientist_files/figure-html/unnamed-chunk-319-1.png" width="672" /></p>
<p>Esa transformación <span class="math inline">\(log(\frac{p}{1-p})\)</span> ha permitido realizar un modelo lineal “con sentido” porque no se está modelizando el 1/0, se está modelizando la razón de probabilidades <span class="math inline">\(log(\frac{p}{1-p})\)</span> que es conocida como <em>odds ratio</em>, una razón que determina cuantas veces más se produce el 1 sobre el 0. Ya que no se puede modelizar cuando toma valor 0 o 1 se modeliza cuanto es más probable tener un 1 sobre un 0. Esa es la transformación llevada a cabo, es la función que enlaza el modelo lineal con la clasificación binomial. En el caso concreto de la regresión logística esta será la <strong>función de enlace</strong> que permite emplear un modelo lineal.</p>
<p>Las funciones de enlace más empleadas son:</p>
<ul>
<li>Normal: <span class="math inline">\(X\beta = E[Y]\)</span> la media</li>
<li>Binomial: <span class="math inline">\(X\beta = log(\frac{p}{1-p})\)</span> función logística</li>
<li>Poisson: <span class="math inline">\(X\beta = log(E[Y])\)</span> función logarítmica</li>
<li>Gamma: <span class="math inline">\(X\beta = \frac{1}{E[Y]}\)</span> función recíproca</li>
</ul>
<p>Para los GLM el método de estimación de los parámetros más adecuado no son los mínimos cuadrados y por ello se emplea la <strong>estimación por máxima verosimilitud</strong> que conceptualmente es parecida a la estimación de parámetros que se trató en el tema 12. Conocida la distribución y a partir de los datos disponibles, se busca el parámetro más verosímil. Existen distintos algoritmos capaces de encontrar estos parámetros. Si se desea profundizar más en aspectos teóricos sobre la estimación de los parámetros por este método se recomienda <a href="https://tereom.github.io/fundamentos/S-max-verosimilitud.html" target="_blank">leer este enlace</a>.</p>
</div>
<div id="regresión-logística" class="section level2 hasAnchor" number="15.3">
<h2><span class="header-section-number">15.3</span> Regresión logística<a href="modelos-GLM.html#regresión-logística" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>La regresión logística permite hacer clasificación binomial problema al que el científico de datos se enfrentará en múltiples ocasiones. En el ejemplo de trabajo se plantea un modelo de clasificación binomial que permita identificar que clientes son más propensos a contratar un seguro de automóviles dentro de la cartera de seguros de salud, lo que se conoce como un <strong>modelo de venta cruzada</strong>, habituales dentro del mundo del marketing analítico. En este caso una regresión logística se adecua a las necesidades del análisis.</p>
<p>Para entender como trabaja una regresión logística se realiza un modelo sencillo con una sola variable, con los datos de trabajo se realiza un modelo únicamente con la variable <code>Age</code>.</p>
<div class="sourceCode" id="cb424"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb424-1"><a href="modelos-GLM.html#cb424-1" aria-hidden="true" tabindex="-1"></a>modelo.prueba3 <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="at">data=</span>train, <span class="at">formula=</span>Response <span class="sc">~</span> Age, <span class="at">family =</span> binomial)</span></code></pre></div>
<p>El código es completamente análogo al visto en los modelos de regresión lineal pero se emplea la función <code>glm</code> y es necesario indicar la función de enlace que en este caso es la que viene de la familia binomial. Sumarizando el modelo se tiene:</p>
<div class="sourceCode" id="cb425"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb425-1"><a href="modelos-GLM.html#cb425-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo.prueba3)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = Response ~ Age, family = binomial, data = train)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -0.7718  -0.5431  -0.4564  -0.4304   2.2279  
## 
## Coefficients:
##               Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept) -2.8053935  0.0138401 -202.70   &lt;2e-16 ***
## Age          0.0205494  0.0003028   67.87   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 283546  on 381108  degrees of freedom
## Residual deviance: 279044  on 381107  degrees of freedom
## AIC: 279048
## 
## Number of Fisher Scoring iterations: 4</code></pre>
<p>La salida que ofrece es parecida a las ya trabajadas, lo primero es estudiar los parámetros y se aprecia que la variable es significativa aunque el valor del parámetro es próximo a 0 el test de parámetros se interpreta exactamente igual que en la regresión lineal. En este caso no aparece el <span class="math inline">\(R^2\)</span> y si aparece el AIC (Akaike information criterion) que es una medida de lo bueno que es el modelo pero al contrario que el <span class="math inline">\(R^2\)</span> no se va a establecer un valor de referencia, el modelo será mejor cuanto menor sea el AIC. Para estudiar como estima el modelo se retoma la función <code>bivariable</code> vista en el capítulo 11.</p>
<div class="sourceCode" id="cb427"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb427-1"><a href="modelos-GLM.html#cb427-1" aria-hidden="true" tabindex="-1"></a>bivariable <span class="ot">&lt;-</span> <span class="cf">function</span>(df, target, varib, <span class="at">ajuste=</span><span class="dv">1</span>){</span>
<span id="cb427-2"><a href="modelos-GLM.html#cb427-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb427-3"><a href="modelos-GLM.html#cb427-3" aria-hidden="true" tabindex="-1"></a>target <span class="ot">=</span> <span class="fu">as.symbol</span>(target)</span>
<span id="cb427-4"><a href="modelos-GLM.html#cb427-4" aria-hidden="true" tabindex="-1"></a>fr_analisis <span class="ot">=</span> <span class="fu">as.symbol</span>(varib)</span>
<span id="cb427-5"><a href="modelos-GLM.html#cb427-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb427-6"><a href="modelos-GLM.html#cb427-6" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb427-7"><a href="modelos-GLM.html#cb427-7" aria-hidden="true" tabindex="-1"></a>   <span class="fu">group_by</span>(<span class="at">factor_analisis =</span> <span class="fu">as.factor</span>(<span class="sc">!!</span>fr_analisis)) <span class="sc">%&gt;%</span></span>
<span id="cb427-8"><a href="modelos-GLM.html#cb427-8" aria-hidden="true" tabindex="-1"></a>   <span class="fu">summarise</span>(<span class="at">pct_clientes =</span> <span class="fu">round</span>(<span class="fu">n</span>()<span class="sc">*</span><span class="dv">100</span><span class="sc">/</span><span class="fu">nrow</span>(df),<span class="dv">1</span>),</span>
<span id="cb427-9"><a href="modelos-GLM.html#cb427-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">pct_interesados =</span> <span class="fu">round</span>(<span class="fu">sum</span>(<span class="sc">!!</span>target)<span class="sc">*</span><span class="dv">100</span><span class="sc">/</span><span class="fu">n</span>(),<span class="dv">1</span>), <span class="at">.groups=</span><span class="st">&#39;drop&#39;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb427-10"><a href="modelos-GLM.html#cb427-10" aria-hidden="true" tabindex="-1"></a>   <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>factor_analisis)) <span class="sc">+</span></span>
<span id="cb427-11"><a href="modelos-GLM.html#cb427-11" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y=</span>pct_interesados <span class="sc">*</span> ajuste), <span class="at">group=</span><span class="dv">1</span>, <span class="at">color=</span><span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb427-12"><a href="modelos-GLM.html#cb427-12" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">y=</span>pct_clientes),<span class="at">fill=</span><span class="st">&quot;yellow&quot;</span>,<span class="at">alpha=</span><span class="fl">0.5</span>)  <span class="sc">+</span></span>
<span id="cb427-13"><a href="modelos-GLM.html#cb427-13" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_text</span>(<span class="at">size=</span><span class="dv">3</span>, <span class="fu">aes</span>(<span class="at">y=</span>pct_interesados <span class="sc">*</span> ajuste, <span class="at">label =</span> <span class="fu">paste</span>(pct_interesados,<span class="st">&#39; %&#39;</span>)), <span class="at">color=</span><span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb427-14"><a href="modelos-GLM.html#cb427-14" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_y_continuous</span>(<span class="at">sec.axis =</span> <span class="fu">sec_axis</span>(<span class="sc">~</span>.<span class="sc">/</span>ajuste, <span class="at">name=</span><span class="st">&quot;% interesados&quot;</span>), <span class="at">name=</span><span class="st">&#39;% clientes&#39;</span>) <span class="sc">+</span></span>
<span id="cb427-15"><a href="modelos-GLM.html#cb427-15" aria-hidden="true" tabindex="-1"></a>   <span class="fu">theme_light</span>()</span>
<span id="cb427-16"><a href="modelos-GLM.html#cb427-16" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb427-17"><a href="modelos-GLM.html#cb427-17" aria-hidden="true" tabindex="-1"></a>g <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste0</span>(<span class="st">&quot;Análisis de la variable &quot;</span>,varib))</span>
<span id="cb427-18"><a href="modelos-GLM.html#cb427-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb427-19"><a href="modelos-GLM.html#cb427-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb427-20"><a href="modelos-GLM.html#cb427-20" aria-hidden="true" tabindex="-1"></a>bivariable_Age <span class="ot">&lt;-</span> <span class="fu">bivariable</span>(train, <span class="st">&#39;Response&#39;</span>, <span class="st">&#39;Age&#39;</span>, <span class="fl">0.5</span>)</span></code></pre></div>
<p>Código ya conocido que genera un gráfico de análisis bivariable. Sobre este análisis se va a presentar la estimación del modelo. Se necesita cierto trabajo para poder llevar a cabo la representación gráfica
.</p>
<div class="sourceCode" id="cb428"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb428-1"><a href="modelos-GLM.html#cb428-1" aria-hidden="true" tabindex="-1"></a>edades <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(train<span class="sc">$</span>Age),<span class="fu">max</span>(train<span class="sc">$</span>Age))</span>
<span id="cb428-2"><a href="modelos-GLM.html#cb428-2" aria-hidden="true" tabindex="-1"></a>edades <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Age=</span>edades)</span>
<span id="cb428-3"><a href="modelos-GLM.html#cb428-3" aria-hidden="true" tabindex="-1"></a>edades<span class="sc">$</span>estimacion <span class="ot">&lt;-</span> <span class="fu">predict</span>(modelo.prueba3, <span class="at">newdata=</span>edades, <span class="at">type=</span><span class="st">&#39;response&#39;</span>)</span>
<span id="cb428-4"><a href="modelos-GLM.html#cb428-4" aria-hidden="true" tabindex="-1"></a><span class="fu">datatable</span>(edades)</span></code></pre></div>
<div id="htmlwidget-628f240164b116379de3" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-628f240164b116379de3">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66"],[20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85],[0.0836003502458469,0.085188200539015,0.086803352734001,0.0884461672074413,0.0901170049045245,0.0918162271540059,0.0935441954757401,0.0953012713806279,0.0970878161628742,0.0989041906844679,0.100750755151796,0.102627868884316,0.104535890075227,0.106475175544065,0.108446080481192,0.110448958184143,0.11248415978579,0.11455203397433,0.11665292670509,0.118787180904174,0.120955136163961,0.123157128430532,0.125393489683063,0.127664547605277,0.129970625249044,0.132312040690258,0.134689106677111,0.137102130270931,0.139551412479754,0.142037247884834,0.144559924260303,0.147119722186229,0.149716914655335,0.152351766673675,0.155024534855572,0.157735467013164,0.160484801740926,0.163272767995553,0.166099584671615,0.168965460173452,0.171870591983754,0.174815166229333,0.177799357244621,0.180823327133428,0.183887225329557,0.186991188156874,0.190135338389453,0.193319784812486,0.196544621784605,0.199809928802357,0.203115770067545,0.206462194058207,0.209849233104002,0.213276902966815,0.216745202427396,0.220254112878886,0.22380359792808,0.227393603005306,0.231024054983815,0.23469486180959,0.238405912142473,0.242157075009558,0.245948199471762,0.249779114304518,0.253649627693531,0.257559526946526]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Age<\/th>\n      <th>estimacion<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,2]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<p>Un paréntesis antes de graficar los resultados, se realiza la estimación para las posibles edades del conjunto de datos, del mínimo al máximo. Se emplea la función <code>predict</code> donde el nuevo conjunto de datos es ese posible rango de edades y es necesario especificar que se requiere la respuesta <code>response</code> ofrecida por el modelo. Es lo que permite realizar el gráfico, ahora se representa esa estimación sobre el análisis bivariable visto en el capítulo 11 del ensayo.</p>
<div class="sourceCode" id="cb429"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb429-1"><a href="modelos-GLM.html#cb429-1" aria-hidden="true" tabindex="-1"></a>bivariable_Age <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y=</span>edades<span class="sc">$</span>estimacion<span class="sc">*</span><span class="dv">50</span>), <span class="at">group=</span><span class="dv">1</span>, <span class="at">color=</span><span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<p><img src="estadistica-data-scientist_files/figure-html/unnamed-chunk-324-1.png" width="672" /></p>
<p>Recordar las particularidades de ggplot con los gráficos de dos ejes, es necesario transformar los datos en % * 100 pero se ajustaba la salida y por ello hay que multiplicar por 50 en vez de por 100. Se observa que el modelo tiene muchas deficiencias, es creciente, un modelo lineal no puede recoger esa forma que presenta la variable dependiente en función de <code>Age</code> ya que hay un comportamiento que claramente no es lineal. Sin embargo, si se considera la edad como un factor y se realiza el modelo:</p>
<div class="sourceCode" id="cb430"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb430-1"><a href="modelos-GLM.html#cb430-1" aria-hidden="true" tabindex="-1"></a>modelo.prueba4<span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="at">data=</span>train, <span class="at">formula=</span>Response <span class="sc">~</span> <span class="fu">as.factor</span>(Age), <span class="at">family =</span> binomial)</span>
<span id="cb430-2"><a href="modelos-GLM.html#cb430-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo.prueba4)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = Response ~ as.factor(Age), family = binomial, data = train)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -0.7204  -0.6476  -0.3774  -0.2691   2.6817  
## 
## Coefficients:
##                  Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)      -3.56797    0.07754 -46.013  &lt; 2e-16 ***
## as.factor(Age)21  0.24759    0.08842   2.800 0.005107 ** 
## as.factor(Age)22  0.29174    0.08587   3.398 0.000680 ***
## as.factor(Age)23  0.30248    0.08472   3.571 0.000356 ***
## as.factor(Age)24  0.25619    0.08455   3.030 0.002444 ** 
## as.factor(Age)25  0.26790    0.08617   3.109 0.001878 ** 
## as.factor(Age)26  0.27343    0.09031   3.028 0.002464 ** 
## as.factor(Age)27  0.48399    0.09074   5.334 9.61e-08 ***
## as.factor(Age)28  0.96198    0.08805  10.925  &lt; 2e-16 ***
## as.factor(Age)29  1.38871    0.08653  16.049  &lt; 2e-16 ***
## as.factor(Age)30  1.66058    0.08621  19.262  &lt; 2e-16 ***
## as.factor(Age)31  1.91254    0.08579  22.293  &lt; 2e-16 ***
## as.factor(Age)32  2.05752    0.08581  23.978  &lt; 2e-16 ***
## as.factor(Age)33  2.28218    0.08479  26.916  &lt; 2e-16 ***
## as.factor(Age)34  2.30242    0.08487  27.128  &lt; 2e-16 ***
## as.factor(Age)35  2.33283    0.08470  27.543  &lt; 2e-16 ***
## as.factor(Age)36  2.34491    0.08448  27.758  &lt; 2e-16 ***
## as.factor(Age)37  2.26224    0.08435  26.819  &lt; 2e-16 ***
## as.factor(Age)38  2.35143    0.08370  28.092  &lt; 2e-16 ***
## as.factor(Age)39  2.26013    0.08329  27.136  &lt; 2e-16 ***
## as.factor(Age)40  2.28025    0.08268  27.579  &lt; 2e-16 ***
## as.factor(Age)41  2.23558    0.08243  27.119  &lt; 2e-16 ***
## as.factor(Age)42  2.21995    0.08232  26.969  &lt; 2e-16 ***
## as.factor(Age)43  2.26662    0.08196  27.655  &lt; 2e-16 ***
## as.factor(Age)44  2.28299    0.08196  27.854  &lt; 2e-16 ***
## as.factor(Age)45  2.28422    0.08205  27.839  &lt; 2e-16 ***
## as.factor(Age)46  2.28268    0.08222  27.762  &lt; 2e-16 ***
## as.factor(Age)47  2.29418    0.08252  27.802  &lt; 2e-16 ***
## as.factor(Age)48  2.24835    0.08281  27.150  &lt; 2e-16 ***
## as.factor(Age)49  2.15788    0.08350  25.844  &lt; 2e-16 ***
## as.factor(Age)50  2.18506    0.08372  26.100  &lt; 2e-16 ***
## as.factor(Age)51  2.11262    0.08435  25.046  &lt; 2e-16 ***
## as.factor(Age)52  2.09206    0.08482  24.665  &lt; 2e-16 ***
## as.factor(Age)53  2.02006    0.08550  23.627  &lt; 2e-16 ***
## as.factor(Age)54  2.08587    0.08567  24.347  &lt; 2e-16 ***
## as.factor(Age)55  1.93729    0.08739  22.167  &lt; 2e-16 ***
## as.factor(Age)56  1.95468    0.08826  22.147  &lt; 2e-16 ***
## as.factor(Age)57  1.97065    0.08845  22.279  &lt; 2e-16 ***
## as.factor(Age)58  1.90287    0.08927  21.316  &lt; 2e-16 ***
## as.factor(Age)59  1.82662    0.09052  20.180  &lt; 2e-16 ***
## as.factor(Age)60  1.70544    0.09190  18.558  &lt; 2e-16 ***
## as.factor(Age)61  1.66613    0.09306  17.903  &lt; 2e-16 ***
## as.factor(Age)62  1.69095    0.09387  18.014  &lt; 2e-16 ***
## as.factor(Age)63  1.52839    0.09590  15.938  &lt; 2e-16 ***
## as.factor(Age)64  1.52817    0.09725  15.713  &lt; 2e-16 ***
## as.factor(Age)65  1.54144    0.09744  15.819  &lt; 2e-16 ***
## as.factor(Age)66  1.35226    0.10075  13.421  &lt; 2e-16 ***
## as.factor(Age)67  1.42705    0.10031  14.226  &lt; 2e-16 ***
## as.factor(Age)68  1.25633    0.10492  11.974  &lt; 2e-16 ***
## as.factor(Age)69  1.27491    0.10372  12.291  &lt; 2e-16 ***
## as.factor(Age)70  1.15465    0.10797  10.694  &lt; 2e-16 ***
## as.factor(Age)71  1.17697    0.11117  10.587  &lt; 2e-16 ***
## as.factor(Age)72  1.16631    0.11165  10.446  &lt; 2e-16 ***
## as.factor(Age)73  1.15352    0.11361  10.153  &lt; 2e-16 ***
## as.factor(Age)74  1.10648    0.11640   9.506  &lt; 2e-16 ***
## as.factor(Age)75  0.91885    0.12694   7.238 4.54e-13 ***
## as.factor(Age)76  1.08925    0.12668   8.598  &lt; 2e-16 ***
## as.factor(Age)77  0.85066    0.13568   6.270 3.62e-10 ***
## as.factor(Age)78  0.88765    0.14040   6.322 2.58e-10 ***
## as.factor(Age)79  0.91121    0.15443   5.900 3.63e-09 ***
## as.factor(Age)80  0.90027    0.15537   5.794 6.85e-09 ***
## as.factor(Age)81  1.00302    0.52464   1.912 0.055898 .  
## as.factor(Age)82  0.23576    1.02065   0.231 0.817321    
## as.factor(Age)83  0.52344    1.02647   0.510 0.610088    
## as.factor(Age)84 -6.99806   36.02105  -0.194 0.845959    
## as.factor(Age)85 -6.99806   36.02105  -0.194 0.845959    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 283546  on 381108  degrees of freedom
## Residual deviance: 260606  on 381043  degrees of freedom
## AIC: 260738
## 
## Number of Fisher Scoring iterations: 9</code></pre>
<p>Cada edad tiene un parámetro asociado y se puede apreciar que casi todos son significativos a excepción de las edades más avanzadas donde los parámetros no superan el test <span class="math inline">\(\beta_i=0\)</span>, curiosamente en el capítulo 12 cuando se trataron los intervalos de confianza en esos mismos rangos de edad se obtenían unos intervalos muy amplios para la media y se llegó a la conclusión de que el número de clientes en edades avanzadas es susceptible de ser agrupado. De nuevo un tema visto con anterioridad puede resultar útil para mejorar el proceso de modelización.</p>
<p>Volviendo con los parámetros, para transformar los modelos en probabilidad se tenía la siguiente función:</p>
<p><span class="math display">\[\hat{p}(Y=1|X)=\frac{exp({\hat{\beta_0}+\hat{\beta_1}X})}{1+exp({\hat{\beta_0}+\hat{\beta_1}X})}\]</span></p>
<p>Anteriormente se justificó por ser la transformación de la función de enlace. Para la edad más baja se tiene la siguiente estimación:</p>
<p><span class="math display">\[\hat{p}(Y=1|X)=\frac{exp({-3.56797})} {1 + exp({-3.56797})}\]</span></p>
<p>Se recuerda que <strong>no aparece el parámetro</strong> para <code>Age</code>=20 porque no es necesario, es el <span class="math inline">\(\beta_0\)</span>, el nivel base y el resultado es 0.0274389, para <code>Age</code>=21 se tendría:</p>
<p><span class="math display">\[\hat{p}(Y=1|X)=\frac{exp({-3.56797+0.24759})} {1 + exp({-3.56797+0.24759})}\]</span></p>
<p>Con resultado:</p>
<p>0.0348786 y así para cada una de las edades. ¿Qué está estimando el modelo? Se va a entender con el siguiente código en R donde se une la media con la estimación del modelo.</p>
<div class="sourceCode" id="cb432"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb432-1"><a href="modelos-GLM.html#cb432-1" aria-hidden="true" tabindex="-1"></a>resumen <span class="ot">&lt;-</span> train <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Age) <span class="sc">%&gt;%</span> </span>
<span id="cb432-2"><a href="modelos-GLM.html#cb432-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">porcen_interesados =</span> <span class="fu">round</span>(<span class="fu">sum</span>(Response)<span class="sc">/</span><span class="fu">n</span>(),<span class="dv">3</span>))</span>
<span id="cb432-3"><a href="modelos-GLM.html#cb432-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb432-4"><a href="modelos-GLM.html#cb432-4" aria-hidden="true" tabindex="-1"></a>resumen<span class="sc">$</span>prediccion <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">predict</span>(modelo.prueba4, <span class="at">newdata =</span> resumen, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>),<span class="dv">3</span>)</span>
<span id="cb432-5"><a href="modelos-GLM.html#cb432-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb432-6"><a href="modelos-GLM.html#cb432-6" aria-hidden="true" tabindex="-1"></a><span class="fu">datatable</span>(resumen)</span></code></pre></div>
<div id="htmlwidget-42fff268773947ad8455" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-42fff268773947ad8455">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66"],[20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85],[0.027,0.035,0.036,0.037,0.035,0.036,0.036,0.044,0.069,0.102,0.129,0.16,0.181,0.217,0.22,0.225,0.227,0.213,0.229,0.213,0.216,0.209,0.206,0.214,0.217,0.217,0.217,0.219,0.211,0.196,0.201,0.189,0.186,0.175,0.185,0.164,0.166,0.168,0.159,0.149,0.134,0.13,0.133,0.115,0.115,0.116,0.098,0.105,0.09,0.092,0.082,0.084,0.083,0.082,0.079,0.066,0.077,0.062,0.064,0.066,0.065,0.071,0.034,0.045,0,0],[0.027,0.035,0.036,0.037,0.035,0.036,0.036,0.044,0.069,0.102,0.129,0.16,0.181,0.217,0.22,0.225,0.227,0.213,0.229,0.213,0.216,0.209,0.206,0.214,0.217,0.217,0.217,0.219,0.211,0.196,0.201,0.189,0.186,0.175,0.185,0.164,0.166,0.168,0.159,0.149,0.134,0.13,0.133,0.115,0.115,0.116,0.098,0.105,0.09,0.092,0.082,0.084,0.083,0.082,0.079,0.066,0.077,0.062,0.064,0.066,0.065,0.071,0.034,0.045,0,0]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Age<\/th>\n      <th>porcen_interesados<\/th>\n      <th>prediccion<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,2,3]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<p>Si, el modelo con una sola variable está estimando la media porque es el estimador más verosímil en un modelo de clasificación binomial para una sola variable. La regresión logística está calculando la proporción de 1s para cada factor. Gráficamente.</p>
<div class="sourceCode" id="cb433"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb433-1"><a href="modelos-GLM.html#cb433-1" aria-hidden="true" tabindex="-1"></a>bivariable_Age <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y=</span>resumen<span class="sc">$</span>prediccion<span class="sc">*</span><span class="dv">50</span>), <span class="at">group=</span><span class="dv">1</span>, <span class="at">color=</span><span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<p><img src="estadistica-data-scientist_files/figure-html/unnamed-chunk-327-1.png" width="672" /></p>
<p><strong>El modelo ajusta perfectamente la proporción de respuestas positivas</strong>, ¿es un buen modelo? Parece que sí, identifica perfectamente los porcentajes de respuestas positivas, esto se ha conseguido con un modelo que tiene un parámetro para cada edad y muchos parámetros implicaban mayor complejidad y esa complejidad está describiendo a la perfección el problema que se planteaba el científico de datos. Ahora bien, ¿el modelo “se ha aprendido” los datos? ¿qué pasaría con otros datos? Cuando un modelo se conoce a la perfección los datos con los que se entrena se comete un <strong>sobreajuste</strong> (overfitting en inglés) o una <em>sobreparametrización</em>. Un exceso de complejidad hace que el modelo conozca a la perfección los datos empleados para su entrenamiento. Se torna necesario probar el modelo con otro conjunto de datos y agrupar la variable independiente para identificar la tendencia pero sin ajustarse a la perfección a cada nivel del factor <code>Age</code>. En capítulos posteriores se verá como poder controlar esta sobreparametrización.</p>
<p>El modelo de regresión logística está ajustando las medias de la proporción a los factores, entonces, si se cruzan factores no será necesario emplear una regresión logística ya que el cruce del múltiples factores daría un resultado muy similar, no exactamente el mismo debido a la estimación por máxima verosimilitud. Por ejemplo con dos factores.</p>
<div class="sourceCode" id="cb434"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb434-1"><a href="modelos-GLM.html#cb434-1" aria-hidden="true" tabindex="-1"></a>resumen <span class="ot">&lt;-</span> train <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Age, Gender) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">porcen_interesados=</span><span class="fu">mean</span>(Response))</span>
<span id="cb434-2"><a href="modelos-GLM.html#cb434-2" aria-hidden="true" tabindex="-1"></a><span class="fu">datatable</span>(resumen)</span></code></pre></div>
<div id="htmlwidget-5c3d27f8689fed326e95" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-5c3d27f8689fed326e95">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132"],[20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,30,30,31,31,32,32,33,33,34,34,35,35,36,36,37,37,38,38,39,39,40,40,41,41,42,42,43,43,44,44,45,45,46,46,47,47,48,48,49,49,50,50,51,51,52,52,53,53,54,54,55,55,56,56,57,57,58,58,59,59,60,60,61,61,62,62,63,63,64,64,65,65,66,66,67,67,68,68,69,69,70,70,71,71,72,72,73,73,74,74,75,75,76,76,77,77,78,78,79,79,80,80,81,81,82,82,83,83,84,84,85,85],["Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male","Female","Male"],[0.0239393939393939,0.0313778990450205,0.0276971186062095,0.0434492869518859,0.0320387524432736,0.0419702076764162,0.0309563697283123,0.0443621164624299,0.0280188614774824,0.0444071687119273,0.0271148746899324,0.046618222470654,0.0260257601912097,0.0479680213191206,0.0374069058903182,0.051525144270404,0.0597510373443983,0.0792007703418392,0.0889774236387782,0.114628820960699,0.111976630963973,0.146049732451999,0.146676852559206,0.172771250863856,0.164593698175788,0.196055684454756,0.205414697034809,0.226239284383153,0.204873646209386,0.232549458753266,0.213498622589532,0.234590282813633,0.223478260869565,0.230657989877079,0.221194280908326,0.206930693069307,0.226151315789474,0.230323367907261,0.222750548646672,0.205582393988191,0.209720372836218,0.220941402497598,0.203542573026725,0.212483399734396,0.210509950248756,0.203297850135671,0.218280216476248,0.211113285071415,0.217066334475241,0.216478818499806,0.210683477106835,0.220545560069646,0.210332103321033,0.220498162515312,0.217536071032186,0.219234079173838,0.204961832061069,0.214333407522813,0.185446985446985,0.202375296912114,0.2007452258966,0.200437317784257,0.18491124260355,0.191407254952405,0.180635085892764,0.188879803761243,0.145691609977324,0.190075693860387,0.162310030395137,0.196300715990453,0.141509433962264,0.174692793091996,0.163703703703704,0.167342425359381,0.158555729984301,0.173033707865169,0.146942017474186,0.165040967616075,0.127868852459016,0.159983291562239,0.115508885298869,0.144599303135889,0.116738197424893,0.136948529411765,0.124113475177305,0.137651821862348,0.108228980322004,0.119023397761953,0.102996254681648,0.122334455667789,0.102316602316602,0.124786324786325,0.0889513108614232,0.104405552202776,0.101325757575758,0.107780612244898,0.0917431192660551,0.0891021247429746,0.0877862595419847,0.0944669365721997,0.0841025641025641,0.0807860262008734,0.0753086419753086,0.0894439967767929,0.0692488262910798,0.0929839391377853,0.0885286783042394,0.0774710596616207,0.0789133247089263,0.0783758262511804,0.0716417910447761,0.0620320855614973,0.075885328836425,0.0784557907845579,0.0552763819095477,0.0670037926675095,0.0620567375886525,0.0659509202453988,0.0663507109004739,0.0649087221095335,0.0750605326876513,0.0564516129032258,0.09375,0.0416666666666667,0,0.0769230769230769,0.0666666666666667,0,0,0,0,0]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Age<\/th>\n      <th>Gender<\/th>\n      <th>porcen_interesados<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,3]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<p>Si se promedian 2 factores se tienen n*m niveles de factores, se complica esa estructura, sin embargo, un modelo con esos dos factores.</p>
<div class="sourceCode" id="cb435"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb435-1"><a href="modelos-GLM.html#cb435-1" aria-hidden="true" tabindex="-1"></a>modelo.prueba5 <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="at">data=</span>train, Response <span class="sc">~</span> <span class="fu">as.factor</span>(Age) <span class="sc">+</span> Gender, <span class="at">family=</span>binomial)</span>
<span id="cb435-2"><a href="modelos-GLM.html#cb435-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Age =</span> <span class="dv">22</span>, <span class="at">Gender=</span><span class="st">&#39;Female&#39;</span>)</span>
<span id="cb435-3"><a href="modelos-GLM.html#cb435-3" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(modelo.prueba5, df, <span class="at">type=</span><span class="st">&quot;response&quot;</span>)</span></code></pre></div>
<pre><code>##         1 
## 0.0343814</code></pre>
<p>Los parámetros están recogiendo información del promedio de 1’s de múltiples variables, en este caso factores. La regresión logística está <em>microsegmentando</em> el porcentaje de clientes interesados en función de las propias características de los clientes por lo que se dispone de una herramienta de clasificación binomial que permite tanto estimar como <strong>describir</strong> el comportamiento de una serie de variables independientes con una sola función matemática. A continuación se introducen más variables en el modelo.</p>
<div class="sourceCode" id="cb437"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb437-1"><a href="modelos-GLM.html#cb437-1" aria-hidden="true" tabindex="-1"></a>modelo <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="at">data =</span> train, Response <span class="sc">~</span> <span class="fu">as.factor</span>(Age) <span class="sc">+</span> Gender <span class="sc">+</span> Driving_License <span class="sc">+</span> </span>
<span id="cb437-2"><a href="modelos-GLM.html#cb437-2" aria-hidden="true" tabindex="-1"></a>                <span class="fu">as.factor</span>(Region_Code) <span class="sc">+</span> <span class="fu">as.factor</span>(Previously_Insured) <span class="sc">+</span> Vehicle_Age <span class="sc">+</span></span>
<span id="cb437-3"><a href="modelos-GLM.html#cb437-3" aria-hidden="true" tabindex="-1"></a>                Vehicle_Damage <span class="sc">+</span> Annual_Premium <span class="sc">+</span> <span class="fu">as.factor</span>(Policy_Sales_Channel) <span class="sc">+</span> </span>
<span id="cb437-4"><a href="modelos-GLM.html#cb437-4" aria-hidden="true" tabindex="-1"></a>                Vintage)</span>
<span id="cb437-5"><a href="modelos-GLM.html#cb437-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb437-6"><a href="modelos-GLM.html#cb437-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = Response ~ as.factor(Age) + Gender + Driving_License + 
##     as.factor(Region_Code) + as.factor(Previously_Insured) + 
##     Vehicle_Age + Vehicle_Damage + Annual_Premium + as.factor(Policy_Sales_Channel) + 
##     Vintage, data = train)
## 
## Deviance Residuals: 
##      Min        1Q    Median        3Q       Max  
## -0.47512  -0.19871  -0.04269   0.03564   1.12206  
## 
## Coefficients:
##                                      Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)                        -2.025e-01  1.630e-02 -12.429  &lt; 2e-16 ***
## as.factor(Age)21                    2.608e-02  4.612e-03   5.656 1.55e-08 ***
## as.factor(Age)22                    4.109e-02  4.813e-03   8.536  &lt; 2e-16 ***
## as.factor(Age)23                    4.906e-02  4.804e-03  10.213  &lt; 2e-16 ***
## as.factor(Age)24                    5.608e-02  4.801e-03  11.681  &lt; 2e-16 ***
## as.factor(Age)25                    5.853e-02  4.895e-03  11.958  &lt; 2e-16 ***
## as.factor(Age)26                    6.126e-02  5.115e-03  11.979  &lt; 2e-16 ***
## as.factor(Age)27                    6.620e-02  5.281e-03  12.535  &lt; 2e-16 ***
## as.factor(Age)28                    7.747e-02  5.427e-03  14.275  &lt; 2e-16 ***
## as.factor(Age)29                    8.876e-02  5.612e-03  15.814  &lt; 2e-16 ***
## as.factor(Age)30                    9.650e-02  5.819e-03  16.585  &lt; 2e-16 ***
## as.factor(Age)31                    1.089e-01  5.998e-03  18.158  &lt; 2e-16 ***
## as.factor(Age)32                    1.122e-01  6.156e-03  18.229  &lt; 2e-16 ***
## as.factor(Age)33                    1.289e-01  6.194e-03  20.815  &lt; 2e-16 ***
## as.factor(Age)34                    1.289e-01  6.607e-03  19.509  &lt; 2e-16 ***
## as.factor(Age)35                    1.269e-01  6.646e-03  19.098  &lt; 2e-16 ***
## as.factor(Age)36                    1.177e-01  6.612e-03  17.798  &lt; 2e-16 ***
## as.factor(Age)37                    1.007e-01  6.528e-03  15.433  &lt; 2e-16 ***
## as.factor(Age)38                    1.101e-01  6.466e-03  17.035  &lt; 2e-16 ***
## as.factor(Age)39                    9.117e-02  6.331e-03  14.400  &lt; 2e-16 ***
## as.factor(Age)40                    9.290e-02  6.224e-03  14.927  &lt; 2e-16 ***
## as.factor(Age)41                    8.233e-02  6.157e-03  13.371  &lt; 2e-16 ***
## as.factor(Age)42                    7.839e-02  6.128e-03  12.792  &lt; 2e-16 ***
## as.factor(Age)43                    8.137e-02  6.084e-03  13.374  &lt; 2e-16 ***
## as.factor(Age)44                    8.262e-02  6.098e-03  13.549  &lt; 2e-16 ***
## as.factor(Age)45                    8.203e-02  6.119e-03  13.406  &lt; 2e-16 ***
## as.factor(Age)46                    8.143e-02  6.154e-03  13.232  &lt; 2e-16 ***
## as.factor(Age)47                    8.363e-02  6.218e-03  13.450  &lt; 2e-16 ***
## as.factor(Age)48                    7.510e-02  6.254e-03  12.008  &lt; 2e-16 ***
## as.factor(Age)49                    6.226e-02  6.329e-03   9.837  &lt; 2e-16 ***
## as.factor(Age)50                    6.659e-02  6.389e-03  10.422  &lt; 2e-16 ***
## as.factor(Age)51                    5.506e-02  6.454e-03   8.532  &lt; 2e-16 ***
## as.factor(Age)52                    4.965e-02  6.524e-03   7.610 2.75e-14 ***
## as.factor(Age)53                    4.369e-02  6.586e-03   6.634 3.27e-11 ***
## as.factor(Age)54                    5.090e-02  6.672e-03   7.630 2.36e-14 ***
## as.factor(Age)55                    2.992e-02  6.822e-03   4.386 1.16e-05 ***
## as.factor(Age)56                    3.362e-02  6.975e-03   4.820 1.43e-06 ***
## as.factor(Age)57                    4.039e-02  7.025e-03   5.749 9.01e-09 ***
## as.factor(Age)58                    2.546e-02  7.079e-03   3.596 0.000323 ***
## as.factor(Age)59                    2.243e-02  7.173e-03   3.127 0.001764 ** 
## as.factor(Age)60                    9.406e-03  7.211e-03   1.304 0.192067    
## as.factor(Age)61                    4.050e-03  7.315e-03   0.554 0.579848    
## as.factor(Age)62                    6.734e-03  7.456e-03   0.903 0.366405    
## as.factor(Age)63                   -6.159e-03  7.470e-03  -0.825 0.409650    
## as.factor(Age)64                   -4.305e-03  7.629e-03  -0.564 0.572550    
## as.factor(Age)65                   -8.283e-04  7.672e-03  -0.108 0.914020    
## as.factor(Age)66                   -1.873e-02  7.727e-03  -2.425 0.015326 *  
## as.factor(Age)67                   -1.322e-02  7.809e-03  -1.693 0.090449 .  
## as.factor(Age)68                   -2.141e-02  7.975e-03  -2.685 0.007248 ** 
## as.factor(Age)69                   -2.622e-02  7.893e-03  -3.322 0.000894 ***
## as.factor(Age)70                   -3.107e-02  8.064e-03  -3.853 0.000117 ***
## as.factor(Age)71                   -2.908e-02  8.403e-03  -3.461 0.000538 ***
## as.factor(Age)72                   -2.742e-02  8.425e-03  -3.254 0.001138 ** 
## as.factor(Age)73                   -3.011e-02  8.578e-03  -3.511 0.000447 ***
## as.factor(Age)74                   -3.347e-02  8.717e-03  -3.840 0.000123 ***
## as.factor(Age)75                   -4.640e-02  9.104e-03  -5.097 3.46e-07 ***
## as.factor(Age)76                   -3.705e-02  9.554e-03  -3.878 0.000105 ***
## as.factor(Age)77                   -5.659e-02  9.576e-03  -5.909 3.44e-09 ***
## as.factor(Age)78                   -4.764e-02  1.004e-02  -4.744 2.10e-06 ***
## as.factor(Age)79                   -5.152e-02  1.119e-02  -4.606 4.11e-06 ***
## as.factor(Age)80                   -4.306e-02  1.122e-02  -3.838 0.000124 ***
## as.factor(Age)81                   -1.246e-02  4.042e-02  -0.308 0.757881    
## as.factor(Age)82                   -4.133e-02  5.594e-02  -0.739 0.460009    
## as.factor(Age)83                   -3.512e-02  6.413e-02  -0.548 0.583987    
## as.factor(Age)84                   -1.042e-02  9.056e-02  -0.115 0.908437    
## as.factor(Age)85                   -1.049e-01  9.055e-02  -1.158 0.246720    
## GenderMale                          3.616e-03  9.952e-04   3.633 0.000280 ***
## Driving_License                     8.001e-02  1.060e-02   7.548 4.43e-14 ***
## as.factor(Region_Code)1             2.296e-02  1.160e-02   1.979 0.047767 *  
## as.factor(Region_Code)2             6.097e-02  8.288e-03   7.357 1.89e-13 ***
## as.factor(Region_Code)3             9.322e-02  7.466e-03  12.485  &lt; 2e-16 ***
## as.factor(Region_Code)4             9.494e-02  9.790e-03   9.698  &lt; 2e-16 ***
## as.factor(Region_Code)5             6.680e-02  1.079e-02   6.193 5.92e-10 ***
## as.factor(Region_Code)6             9.645e-02  7.788e-03  12.384  &lt; 2e-16 ***
## as.factor(Region_Code)7             7.161e-02  8.564e-03   8.362  &lt; 2e-16 ***
## as.factor(Region_Code)8             6.546e-02  7.020e-03   9.324  &lt; 2e-16 ***
## as.factor(Region_Code)9             4.991e-02  8.676e-03   5.752 8.83e-09 ***
## as.factor(Region_Code)10            7.903e-02  8.177e-03   9.665  &lt; 2e-16 ***
## as.factor(Region_Code)11            1.113e-01  7.490e-03  14.864  &lt; 2e-16 ***
## as.factor(Region_Code)12            8.182e-02  8.624e-03   9.487  &lt; 2e-16 ***
## as.factor(Region_Code)13            7.242e-02  8.271e-03   8.756  &lt; 2e-16 ***
## as.factor(Region_Code)14            8.754e-02  8.086e-03  10.826  &lt; 2e-16 ***
## as.factor(Region_Code)15            5.820e-02  7.308e-03   7.964 1.67e-15 ***
## as.factor(Region_Code)16            6.385e-02  9.537e-03   6.695 2.16e-11 ***
## as.factor(Region_Code)17            6.678e-02  8.989e-03   7.428 1.10e-13 ***
## as.factor(Region_Code)18            1.051e-01  7.990e-03  13.148  &lt; 2e-16 ***
## as.factor(Region_Code)19            7.823e-02  1.022e-02   7.655 1.93e-14 ***
## as.factor(Region_Code)20            3.551e-02  9.664e-03   3.674 0.000239 ***
## as.factor(Region_Code)21            8.482e-02  8.210e-03  10.331  &lt; 2e-16 ***
## as.factor(Region_Code)22            5.283e-02  1.072e-02   4.930 8.23e-07 ***
## as.factor(Region_Code)23            9.643e-02  9.580e-03  10.066  &lt; 2e-16 ***
## as.factor(Region_Code)24            7.965e-02  9.251e-03   8.610  &lt; 2e-16 ***
## as.factor(Region_Code)25            5.860e-02  9.070e-03   6.462 1.04e-10 ***
## as.factor(Region_Code)26            3.729e-02  9.208e-03   4.049 5.14e-05 ***
## as.factor(Region_Code)27            5.382e-02  8.834e-03   6.092 1.12e-09 ***
## as.factor(Region_Code)28            8.940e-02  6.865e-03  13.024  &lt; 2e-16 ***
## as.factor(Region_Code)29            1.104e-01  7.379e-03  14.963  &lt; 2e-16 ***
## as.factor(Region_Code)30            9.377e-02  7.330e-03  12.793  &lt; 2e-16 ***
## as.factor(Region_Code)31            4.423e-02  9.806e-03   4.510 6.47e-06 ***
## as.factor(Region_Code)32            7.584e-02  8.860e-03   8.559  &lt; 2e-16 ***
## as.factor(Region_Code)33            8.125e-02  7.620e-03  10.662  &lt; 2e-16 ***
## as.factor(Region_Code)34            3.987e-02  1.001e-02   3.982 6.84e-05 ***
## as.factor(Region_Code)35            1.028e-01  7.718e-03  13.318  &lt; 2e-16 ***
## as.factor(Region_Code)36            6.626e-02  7.527e-03   8.803  &lt; 2e-16 ***
## as.factor(Region_Code)37            5.485e-02  7.936e-03   6.912 4.80e-12 ***
## as.factor(Region_Code)38            9.695e-02  9.503e-03  10.201  &lt; 2e-16 ***
## as.factor(Region_Code)39            6.630e-02  8.108e-03   8.177 2.91e-16 ***
## as.factor(Region_Code)40            5.920e-02  1.074e-02   5.510 3.59e-08 ***
## as.factor(Region_Code)41            1.005e-01  7.175e-03  14.012  &lt; 2e-16 ***
## as.factor(Region_Code)42            4.686e-02  1.408e-02   3.328 0.000874 ***
## as.factor(Region_Code)43            5.055e-02  8.950e-03   5.648 1.63e-08 ***
## as.factor(Region_Code)44            5.405e-02  1.255e-02   4.306 1.66e-05 ***
## as.factor(Region_Code)45            8.110e-02  7.884e-03  10.287  &lt; 2e-16 ***
## as.factor(Region_Code)46            8.302e-02  7.132e-03  11.640  &lt; 2e-16 ***
## as.factor(Region_Code)47            5.210e-02  7.686e-03   6.778 1.22e-11 ***
## as.factor(Region_Code)48            2.296e-02  8.251e-03   2.783 0.005384 ** 
## as.factor(Region_Code)49            4.285e-02  9.759e-03   4.390 1.13e-05 ***
## as.factor(Region_Code)50            5.527e-02  7.509e-03   7.361 1.83e-13 ***
## as.factor(Region_Code)51            8.318e-02  2.318e-02   3.588 0.000333 ***
## as.factor(Region_Code)52            7.050e-02  1.957e-02   3.603 0.000314 ***
## as.factor(Previously_Insured)1     -8.774e-02  1.761e-03 -49.837  &lt; 2e-16 ***
## Vehicle_Age&gt; 2 Years                3.967e-02  4.204e-03   9.435  &lt; 2e-16 ***
## Vehicle_Age1-2 Year                -1.801e-02  3.341e-03  -5.391 7.00e-08 ***
## Vehicle_DamageYes                   1.252e-01  1.766e-03  70.904  &lt; 2e-16 ***
## Annual_Premium                      2.601e-07  3.271e-08   7.949 1.88e-15 ***
## as.factor(Policy_Sales_Channel)2    1.034e-01  1.502e-01   0.688 0.491175    
## as.factor(Policy_Sales_Channel)3    2.028e-01  1.633e-02  12.418  &lt; 2e-16 ***
## as.factor(Policy_Sales_Channel)4    1.208e-01  1.645e-02   7.342 2.10e-13 ***
## as.factor(Policy_Sales_Channel)6   -2.165e-02  1.734e-01  -0.125 0.900641    
## as.factor(Policy_Sales_Channel)7    1.093e-01  1.234e-02   8.856  &lt; 2e-16 ***
## as.factor(Policy_Sales_Channel)8    8.483e-02  1.268e-02   6.692 2.21e-11 ***
## as.factor(Policy_Sales_Channel)9    1.062e-01  2.570e-02   4.131 3.62e-05 ***
## as.factor(Policy_Sales_Channel)10   1.071e-01  2.108e-02   5.083 3.71e-07 ***
## as.factor(Policy_Sales_Channel)11   6.288e-02  1.312e-02   4.793 1.64e-06 ***
## as.factor(Policy_Sales_Channel)12   9.958e-02  1.457e-02   6.833 8.31e-12 ***
## as.factor(Policy_Sales_Channel)13   8.295e-02  1.194e-02   6.949 3.69e-12 ***
## as.factor(Policy_Sales_Channel)14   1.042e-01  1.561e-02   6.676 2.46e-11 ***
## as.factor(Policy_Sales_Channel)15   1.273e-01  1.458e-02   8.733  &lt; 2e-16 ***
## as.factor(Policy_Sales_Channel)16   9.987e-02  1.657e-02   6.028 1.66e-09 ***
## as.factor(Policy_Sales_Channel)17   1.655e-01  7.562e-02   2.188 0.028676 *  
## as.factor(Policy_Sales_Channel)18   6.340e-02  2.529e-02   2.507 0.012189 *  
## as.factor(Policy_Sales_Channel)19   7.742e-02  2.236e-02   3.462 0.000535 ***
## as.factor(Policy_Sales_Channel)20   1.017e-01  5.871e-02   1.731 0.083391 .  
## as.factor(Policy_Sales_Channel)21   7.888e-02  2.653e-02   2.974 0.002944 ** 
## as.factor(Policy_Sales_Channel)22   7.542e-02  1.968e-02   3.831 0.000127 ***
## as.factor(Policy_Sales_Channel)23   9.739e-02  1.752e-02   5.558 2.72e-08 ***
## as.factor(Policy_Sales_Channel)24   8.976e-02  1.463e-02   6.135 8.50e-10 ***
## as.factor(Policy_Sales_Channel)25   1.392e-01  1.196e-02  11.641  &lt; 2e-16 ***
## as.factor(Policy_Sales_Channel)26   1.355e-01  9.730e-03  13.925  &lt; 2e-16 ***
## as.factor(Policy_Sales_Channel)27   2.190e-01  1.734e-01   1.263 0.206633    
## as.factor(Policy_Sales_Channel)28   2.562e-01  1.734e-01   1.478 0.139502    
## as.factor(Policy_Sales_Channel)29   8.458e-02  1.416e-02   5.973 2.33e-09 ***
## as.factor(Policy_Sales_Channel)30   8.334e-02  1.259e-02   6.622 3.56e-11 ***
## as.factor(Policy_Sales_Channel)31   1.518e-01  1.536e-02   9.881  &lt; 2e-16 ***
## as.factor(Policy_Sales_Channel)32   5.270e-02  6.615e-02   0.797 0.425610    
## as.factor(Policy_Sales_Channel)33  -1.206e-01  1.734e-01  -0.696 0.486584    
## as.factor(Policy_Sales_Channel)34  -8.041e-02  1.734e-01  -0.464 0.642816    
## as.factor(Policy_Sales_Channel)35   7.748e-02  3.595e-02   2.155 0.031160 *  
## as.factor(Policy_Sales_Channel)36   2.098e-01  4.270e-02   4.913 8.96e-07 ***
## as.factor(Policy_Sales_Channel)37   6.057e-02  2.619e-02   2.313 0.020734 *  
## as.factor(Policy_Sales_Channel)38   3.946e-03  9.531e-02   0.041 0.966971    
## as.factor(Policy_Sales_Channel)39  -2.210e-02  9.531e-02  -0.232 0.816652    
## as.factor(Policy_Sales_Channel)40   5.717e-02  7.802e-02   0.733 0.463671    
## as.factor(Policy_Sales_Channel)41   1.346e-01  3.000e-01   0.449 0.653655    
## as.factor(Policy_Sales_Channel)42   1.227e-01  2.785e-02   4.407 1.05e-05 ***
## as.factor(Policy_Sales_Channel)43   8.251e-01  3.000e-01   2.751 0.005946 ** 
## as.factor(Policy_Sales_Channel)44   1.278e-01  3.137e-02   4.074 4.63e-05 ***
## as.factor(Policy_Sales_Channel)45   3.994e-02  4.480e-02   0.892 0.372588    
## as.factor(Policy_Sales_Channel)46  -2.420e-02  7.558e-02  -0.320 0.748841    
## as.factor(Policy_Sales_Channel)47   5.804e-02  3.901e-02   1.488 0.136787    
## as.factor(Policy_Sales_Channel)48   1.677e-02  6.775e-02   0.248 0.804448    
## as.factor(Policy_Sales_Channel)49   1.151e-01  8.072e-02   1.426 0.153954    
## as.factor(Policy_Sales_Channel)50  -1.175e-01  2.122e-01  -0.553 0.579929    
## as.factor(Policy_Sales_Channel)51   2.872e-02  8.710e-02   0.330 0.741608    
## as.factor(Policy_Sales_Channel)52   6.373e-02  1.340e-02   4.756 1.98e-06 ***
## as.factor(Policy_Sales_Channel)53   1.257e-01  5.388e-02   2.333 0.019634 *  
## as.factor(Policy_Sales_Channel)54   6.183e-02  3.151e-02   1.962 0.049758 *  
## as.factor(Policy_Sales_Channel)55   8.569e-02  1.287e-02   6.659 2.77e-11 ***
## as.factor(Policy_Sales_Channel)56   1.024e-01  3.844e-02   2.663 0.007736 ** 
## as.factor(Policy_Sales_Channel)57   4.977e-02  1.344e-01   0.370 0.711238    
## as.factor(Policy_Sales_Channel)58   1.727e-02  1.004e-01   0.172 0.863440    
## as.factor(Policy_Sales_Channel)59   1.062e-01  2.833e-02   3.747 0.000179 ***
## as.factor(Policy_Sales_Channel)60   6.615e-02  1.637e-02   4.042 5.31e-05 ***
## as.factor(Policy_Sales_Channel)61   5.071e-02  1.579e-02   3.211 0.001321 ** 
## as.factor(Policy_Sales_Channel)62   1.742e-01  1.228e-01   1.419 0.155978    
## as.factor(Policy_Sales_Channel)63   9.071e-02  6.951e-02   1.305 0.191870    
## as.factor(Policy_Sales_Channel)64   3.998e-02  3.333e-02   1.199 0.230443    
## as.factor(Policy_Sales_Channel)65   4.454e-02  4.032e-02   1.105 0.269230    
## as.factor(Policy_Sales_Channel)66   8.533e-02  7.138e-02   1.196 0.231886    
## as.factor(Policy_Sales_Channel)67  -1.625e-01  1.502e-01  -1.082 0.279332    
## as.factor(Policy_Sales_Channel)68   2.819e-01  1.503e-01   1.876 0.060686 .  
## as.factor(Policy_Sales_Channel)69   1.550e-01  1.228e-01   1.262 0.207003    
## as.factor(Policy_Sales_Channel)70  -1.174e-01  1.503e-01  -0.781 0.434588    
## as.factor(Policy_Sales_Channel)71  -4.776e-02  1.344e-01  -0.355 0.722417    
## as.factor(Policy_Sales_Channel)73  -2.797e-02  8.374e-02  -0.334 0.738339    
## as.factor(Policy_Sales_Channel)74  -3.392e-02  2.122e-01  -0.160 0.873011    
## as.factor(Policy_Sales_Channel)75  -3.801e-02  2.122e-01  -0.179 0.857874    
## as.factor(Policy_Sales_Channel)76   4.218e-02  1.502e-01   0.281 0.778925    
## as.factor(Policy_Sales_Channel)78   1.274e-01  6.328e-02   2.014 0.044054 *  
## as.factor(Policy_Sales_Channel)79  -1.480e-01  1.228e-01  -1.206 0.227947    
##  [ reached getOption(&quot;max.print&quot;) -- omitted 80 rows ]
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for gaussian family taken to be 0.08987578)
## 
##     Null deviance: 40985  on 381108  degrees of freedom
## Residual deviance: 34227  on 380829  degrees of freedom
## AIC: 163606
## 
## Number of Fisher Scoring iterations: 2</code></pre>
<p>Esta estructura es de difícil interpretación ya que se disponen de múltiples factores con muchos niveles, es necesario un paso previo de agrupación de niveles que se ha tratado en capítulos anteriores. Hay variables cuantitativas como <code>Annual_Premium</code> que pueden tener comportamientos no lineales por lo que podría ser interesante realizar un ejercicio previo de tramificación de esta variable cuantitativa.</p>
<p>En este proceso de modelización se está poniendo de relieve la importancia de todos los capítulos anteriores ya que se está esbozando la necesidad de seguir una serie de pasos como:</p>
<ul>
<li>Describir numéricamente y gráficamente las variables que van a participar en el proceso de modelización</li>
<li>Determinar que problemas presentan los datos tanto en observaciones como en variables para establecer cuales de ellas van a participar en ese proceso</li>
<li>Analizar de forma bivariable las variables y las observaciones seleccionadas frente a la variable respuesta</li>
<li>Muestrear los datos para seleccionar los datos que van a entrenar el modelo y los que van a testear los resultados</li>
<li>Comenzar a realizar modelos y experimentar con los resultados</li>
<li>Medir la capacidad predictiva del modelo</li>
<li>…</li>
</ul>
<p>Es decir, es necesario establecer un <strong>método de modelización estadística</strong> que se verá en el siguiente capítulo del ensayo.</p>
</div>
<div id="regresión-de-poisson" class="section level2 hasAnchor" number="15.4">
<h2><span class="header-section-number">15.4</span> Regresión de poisson<a href="modelos-GLM.html#regresión-de-poisson" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Otro de los modelos GLM que debe conocer un científico de datos antes de empezar a realizar modelos más complejos es la regresión de poisson. Para ilustrar la regresión de poisson no es posible emplear los datos de trabajo ya que el problema a estudiar, si un cliente se muestra o no interesado, es un prototipo de clasificación binomial y con la regresión de poisson se estiman/describen <em>número de eventos en un espacio de tiempo</em>. Por este motivo es necesario seleccionar otros datos para mostrar como trabajan este tipo de modelos generalizados. En este caso, los datos son los empleados en algunos ejercicios del libro “Non-Life Insurance Pricin with GLM” y corresponden a una cartera de motos de una compañía aseguradora. Las variables disponibles son la edad, sexo, zona de circulación, clase de la moto, antigüedad de la moto, bonificación del conductor, exposición en años, número de siniestros y el importe de los mismos.</p>
<div class="sourceCode" id="cb439"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb439-1"><a href="modelos-GLM.html#cb439-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb439-2"><a href="modelos-GLM.html#cb439-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DT)</span>
<span id="cb439-3"><a href="modelos-GLM.html#cb439-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb439-4"><a href="modelos-GLM.html#cb439-4" aria-hidden="true" tabindex="-1"></a>varib <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">edad =</span> 2L, <span class="at">sexo =</span> 1L, <span class="at">zona =</span> 1L, <span class="at">clase_moto =</span> 1L, <span class="at">antveh =</span> 2L,</span>
<span id="cb439-5"><a href="modelos-GLM.html#cb439-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">bonus =</span> 1L, <span class="at">exposicion =</span> 8L, <span class="at">nsin =</span> 4L, <span class="at">impsin =</span> 8L)</span>
<span id="cb439-6"><a href="modelos-GLM.html#cb439-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb439-7"><a href="modelos-GLM.html#cb439-7" aria-hidden="true" tabindex="-1"></a>varib.classes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;integer&quot;</span>, <span class="fu">rep</span>(<span class="st">&quot;factor&quot;</span>, <span class="dv">3</span>), <span class="st">&quot;integer&quot;</span>,</span>
<span id="cb439-8"><a href="modelos-GLM.html#cb439-8" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&quot;factor&quot;</span>, <span class="st">&quot;numeric&quot;</span>, <span class="fu">rep</span>(<span class="st">&quot;integer&quot;</span>, <span class="dv">2</span>))</span>
<span id="cb439-9"><a href="modelos-GLM.html#cb439-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb439-10"><a href="modelos-GLM.html#cb439-10" aria-hidden="true" tabindex="-1"></a><span class="co">#con &lt;- url(&quot;http://staff.math.su.se/esbj/GLMbook/mccase.txt&quot;)</span></span>
<span id="cb439-11"><a href="modelos-GLM.html#cb439-11" aria-hidden="true" tabindex="-1"></a>con <span class="ot">&lt;-</span> <span class="st">&quot;./data/mccase.txt&quot;</span></span>
<span id="cb439-12"><a href="modelos-GLM.html#cb439-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb439-13"><a href="modelos-GLM.html#cb439-13" aria-hidden="true" tabindex="-1"></a>moto <span class="ot">&lt;-</span> <span class="fu">read.fwf</span>(con, <span class="at">widths =</span> varib, <span class="at">header =</span> <span class="cn">FALSE</span>,</span>
<span id="cb439-14"><a href="modelos-GLM.html#cb439-14" aria-hidden="true" tabindex="-1"></a>                    <span class="at">col.names =</span> <span class="fu">names</span>(varib),</span>
<span id="cb439-15"><a href="modelos-GLM.html#cb439-15" aria-hidden="true" tabindex="-1"></a>                    <span class="at">colClasses =</span> varib.classes,</span>
<span id="cb439-16"><a href="modelos-GLM.html#cb439-16" aria-hidden="true" tabindex="-1"></a>                    <span class="at">na.strings =</span> <span class="cn">NULL</span>, <span class="at">comment.char =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb439-17"><a href="modelos-GLM.html#cb439-17" aria-hidden="true" tabindex="-1"></a><span class="fu">datatable</span>(<span class="fu">head</span>(moto))</span></code></pre></div>
<div id="htmlwidget-a84fc1256a4d57abe71b" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-a84fc1256a4d57abe71b">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6"],[0,4,5,5,6,9],["M","M","K","K","K","K"],["1","3","3","4","2","3"],["4","6","3","1","1","3"],[12,9,18,25,26,8],["1","1","1","1","1","1"],[0.175342,0,0.454795,0.172603,0.180822,0.542466],[0,0,0,0,0,0],[0,0,0,0,0,0]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>edad<\/th>\n      <th>sexo<\/th>\n      <th>zona<\/th>\n      <th>clase_moto<\/th>\n      <th>antveh<\/th>\n      <th>bonus<\/th>\n      <th>exposicion<\/th>\n      <th>nsin<\/th>\n      <th>impsin<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,5,7,8,9]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<p>El conjunto de datos está disponible en la web pero se ha subido al repositorio de github para facilitar su lectura. En este caso, el modelo que le interesa al científico de datos es uno que estime o describa el número de siniestros <code>nsin</code> en un periodo de tiempo. En los datos actuariales el periodo de tiempo lo marca la exposición al riesgo, campo <code>exposicion</code> en el conjunto de datos. La exposición es el número de días que está expuesto ese riesgo entre el número total de días de exposición, habitualmente un año. Por ejemplo, si una póliza se da de alta el 31/03/2022 de un año y se analizan los datos a año cerrado estará expuesta (31/12/2022 - 31/03/2022) / (31/12/2022-01/01/2022). No es el objeto de este ensayo conocer en profundidad las matizaciones de los datos actuariales, pero al número de siniestros en el periodo de exposición se le conoce como <em>frecuencia siniestral</em> y es lo que se pretende modelizar mediante regresión de poisson. A modo de ejemplo, para calcular la frecuencia siniestral por edad en el conjunto de datos de trabajo se tiene.</p>
<div class="sourceCode" id="cb440"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb440-1"><a href="modelos-GLM.html#cb440-1" aria-hidden="true" tabindex="-1"></a>frec.siniestral <span class="ot">&lt;-</span> moto <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(edad) <span class="sc">%&gt;%</span> </span>
<span id="cb440-2"><a href="modelos-GLM.html#cb440-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">exposicion =</span> <span class="fu">sum</span>(exposicion),</span>
<span id="cb440-3"><a href="modelos-GLM.html#cb440-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">frecuencia =</span> <span class="fu">sum</span>(nsin)<span class="sc">/</span><span class="fu">sum</span>(exposicion))</span>
<span id="cb440-4"><a href="modelos-GLM.html#cb440-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb440-5"><a href="modelos-GLM.html#cb440-5" aria-hidden="true" tabindex="-1"></a><span class="fu">datatable</span>(frec.siniestral)</span></code></pre></div>
<div id="htmlwidget-b17e3cd2c6cc117a178b" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-b17e3cd2c6cc117a178b">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85"],[0,4,5,6,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,91,92],[0.175342,0,0.627398,0.180822,1.046576,1.676713,2.065753,2.49315,2.679452,3.739726,5.087672,82.473974,362.065752,439.802734,342.443833,348.904093,454.649329,618.635609,831.778092,1020.328761,1136.082194,1164.45479,1146.800012,1114.79999,1089.88768,1051.849298,964.128751,886.698627,819.808215,779.054789,770.810955,729.369848,711.591776,729.172608,772.287663,977.265756,1622.630138,2401.805484,2622.523292,2651.402715,2706.304104,2747.158885,2723.073946,2744.860322,2672.295864,2643.613693,2559.471234,2423.002737,2125.506835,1895.043844,1704.728771,1467.027397,1272.468494,1029.890401,921.082179,808.4493,700.109585,578.216449,485.632884,411.358906,368.890412,326.682189,261.778082,218.832877,159.671234,117.852059,82.950687,80.498632,72.049318,46.884932,49.279456,39.879455,36.61644,28.416438,19.073973,11.627396,4.361644,8.742465,9.19726,6.304111,2.465753,1.471233,0.323288,0,0.386301],[0,null,0,0,0,0,0,0,0,0,0,0.0242500743325403,0.0220954342016861,0.0386536933169679,0.0146009345713637,0.028661171366654,0.0219949736250463,0.0501102742050531,0.0444830181942325,0.0401831268186706,0.0316878481065253,0.037785923831358,0.0305197066914576,0.0260136349660355,0.0229381434975024,0.0218662502734303,0.0145208821803925,0.0146611256678984,0.0146375698369893,0.0115524609142734,0.00908134472479053,0.00548418612445849,0.0070265005423559,0.00411425219088866,0.0142433972818753,0.00511631556646911,0.00554655049800388,0.00707800865359336,0.00343180936751047,0.0086746535597479,0.00480359911540821,0.00364012436797954,0.00697740875818288,0.00619339347206317,0.00449052073973498,0.00870021216068803,0.00468846839948505,0.00453982153302041,0.00470476021781412,0.00738769187020456,0.00410622506000985,0.00408990316899992,0.00550111852121032,0.00582586262982366,0.00759975619938685,0.0148432313566231,0.00142834782072009,0.00172945616080182,0.00823667451646458,0.012154835903808,0,0.00306107903544138,0.00382002951645127,0.0182787890687924,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,null,0]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>edad<\/th>\n      <th>exposicion<\/th>\n      <th>frecuencia<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,2,3]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<p>Al igual que sucedía con el ejercicio de marketing analítico es evidente que hay que trabajar las variables. ¿Por qué aparecen edades a 0? ¿Puede haber menores de 18 años? ¿Tendrán sentido niveles de factores con baja exposición? El trabajo del científico de datos siempre empieza en el mismo punto, <strong>conocer y depurar los datos</strong>. Otra situación habitual que se produce cuando se trabajen con datos con exposición al riesgo es la aparición de expuestos con valor 0 y siempre es necesario realizar la correspondiente comprobación.</p>
<div class="sourceCode" id="cb441"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb441-1"><a href="modelos-GLM.html#cb441-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(moto<span class="sc">$</span>exposicion<span class="sc">==</span><span class="dv">0</span>)</span></code></pre></div>
<pre><code>## [1] 2074</code></pre>
<p>Aparecen 2074 riesgos con exposición 0 que no se deben emplear. En este ejemplo y para agilizar el trabajo se eliminan observaciones con edad inferior a 18 y con exposición 0 pero sirva este ejemplo para recalcar la importancia que tienen las fases previas de conocimiento a la hora de realizar modelos estadísticos y reiterar la importancia de trabajar en un método. En este ejemplo se crea una función análoga a la función <code>bivariable</code> empleada en la clasificación binomial pero que permite describir exposición y frecuencia siniestral de forma bivariable.</p>
<div class="sourceCode" id="cb443"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb443-1"><a href="modelos-GLM.html#cb443-1" aria-hidden="true" tabindex="-1"></a>moto <span class="ot">&lt;-</span> moto <span class="sc">%&gt;%</span> <span class="fu">filter</span>(edad<span class="sc">&gt;=</span><span class="dv">18</span> <span class="sc">&amp;</span> exposicion<span class="sc">&gt;</span><span class="dv">0</span>)</span>
<span id="cb443-2"><a href="modelos-GLM.html#cb443-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb443-3"><a href="modelos-GLM.html#cb443-3" aria-hidden="true" tabindex="-1"></a>describe_frecuencia <span class="ot">&lt;-</span> <span class="cf">function</span> (df,varib) {</span>
<span id="cb443-4"><a href="modelos-GLM.html#cb443-4" aria-hidden="true" tabindex="-1"></a>  columna<span class="ot">&lt;-</span><span class="fu">as.symbol</span>(varib)</span>
<span id="cb443-5"><a href="modelos-GLM.html#cb443-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb443-6"><a href="modelos-GLM.html#cb443-6" aria-hidden="true" tabindex="-1"></a>  resumen <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb443-7"><a href="modelos-GLM.html#cb443-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(<span class="sc">!!</span>columna) <span class="sc">%&gt;%</span></span>
<span id="cb443-8"><a href="modelos-GLM.html#cb443-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">porcen_exposicion =</span> <span class="fu">round</span>(<span class="fu">sum</span>(exposicion)<span class="sc">*</span><span class="dv">100</span><span class="sc">/</span><span class="fu">sum</span>(df<span class="sc">$</span>exposicion),<span class="dv">1</span>),</span>
<span id="cb443-9"><a href="modelos-GLM.html#cb443-9" aria-hidden="true" tabindex="-1"></a>              <span class="at">frecuencia =</span> <span class="fu">round</span>(<span class="fu">sum</span>(nsin)<span class="sc">*</span><span class="dv">100</span><span class="sc">/</span><span class="fu">sum</span>(exposicion),<span class="dv">1</span>))</span>
<span id="cb443-10"><a href="modelos-GLM.html#cb443-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb443-11"><a href="modelos-GLM.html#cb443-11" aria-hidden="true" tabindex="-1"></a>  g2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(resumen, <span class="fu">aes</span>(<span class="at">x=</span><span class="fu">factor</span>(<span class="sc">!!</span>columna))) <span class="sc">+</span></span>
<span id="cb443-12"><a href="modelos-GLM.html#cb443-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">y=</span>porcen_exposicion),<span class="at">fill=</span><span class="st">&quot;yellow&quot;</span>,<span class="at">alpha=</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb443-13"><a href="modelos-GLM.html#cb443-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y=</span>frecuencia<span class="sc">*</span><span class="dv">4</span>), <span class="at">group=</span><span class="dv">1</span>, <span class="at">color=</span><span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb443-14"><a href="modelos-GLM.html#cb443-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">y=</span>frecuencia<span class="sc">*</span><span class="dv">4</span>, <span class="at">label =</span> <span class="fu">paste</span>(frecuencia,<span class="st">&quot;%&quot;</span>)), <span class="at">color=</span><span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb443-15"><a href="modelos-GLM.html#cb443-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">sec.axis =</span> <span class="fu">sec_axis</span>(<span class="sc">~</span>.<span class="sc">/</span><span class="dv">4</span>), <span class="at">name=</span><span class="st">&quot;&quot;</span>) <span class="sc">+</span> </span>
<span id="cb443-16"><a href="modelos-GLM.html#cb443-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="fu">paste0</span>(<span class="st">&quot;Análisis de frecuencia siniestral para &quot;</span>, varib)) <span class="sc">+</span> <span class="fu">theme_light</span>()</span>
<span id="cb443-17"><a href="modelos-GLM.html#cb443-17" aria-hidden="true" tabindex="-1"></a>  g2}</span>
<span id="cb443-18"><a href="modelos-GLM.html#cb443-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb443-19"><a href="modelos-GLM.html#cb443-19" aria-hidden="true" tabindex="-1"></a><span class="fu">describe_frecuencia</span>(moto, <span class="st">&#39;edad&#39;</span>)</span></code></pre></div>
<p><img src="estadistica-data-scientist_files/figure-html/unnamed-chunk-334-1.png" width="672" /></p>
<p>Ese comportamiento en la frecuencia siniestral es el que se desea estudiar, esa es la variable respuesta. De forma bivariable se tiene que edades más bajas incrementan su frecuencia sobre todo en edades de 22 años a 25, a partir de 35 años parece más estable hasta los 60 donde se produce un repunte, pero hay que tener en cuenta la baja exposición en rangos de edad mayores. Esta es la interpretación para una sola variable, ¿qué hace el GLM con esta situación?</p>
<div class="sourceCode" id="cb444"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb444-1"><a href="modelos-GLM.html#cb444-1" aria-hidden="true" tabindex="-1"></a>modelo.poisson1 <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="at">data=</span>moto, <span class="at">formula =</span> nsin <span class="sc">~</span> <span class="fu">as.factor</span>(edad) , <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link=</span><span class="st">&#39;log&#39;</span>), </span>
<span id="cb444-2"><a href="modelos-GLM.html#cb444-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">offset=</span><span class="fu">log</span>(exposicion))</span></code></pre></div>
<p>Es necesario puntualizar como se especifica este modelo con glm. Se va a modelizar la frecuencia, es decir, <code>nsin</code>/<code>exposicion</code> pero la exposición es un valor de ponderación, es un <strong>coeficiente predeterminado</strong> y ese dato predeterminado se introduce mediante la opción <code>offset</code>. También es posible formular el modelo del siguiente modo:</p>
<div class="sourceCode" id="cb445"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb445-1"><a href="modelos-GLM.html#cb445-1" aria-hidden="true" tabindex="-1"></a>modelo.poisson1 <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="at">data=</span>moto, <span class="at">formula =</span> nsin <span class="sc">~</span> <span class="fu">as.factor</span>(edad) <span class="sc">+</span> <span class="fu">offset</span>(<span class="fu">log</span>(exposicion)),</span>
<span id="cb445-2"><a href="modelos-GLM.html#cb445-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">family =</span> poisson)</span></code></pre></div>
<p>Con esta otra formulación puede entenderse mejor como es su papel en la estructura del modelo. Por otro lado se pondera por <code>log(exposicion)</code> debido a la propia formulación del modelo.</p>
<p><span class="math display">\[nsin/exposicion = e^{\beta_iX_i + \epsilon} +\]</span></p>
<p>Se tiene que transformar en un modelo aditivo por lo que hay que emplear el logaritmo.</p>
<p><span class="math display">\[log(nsin/exposicion)=\beta_iX_i + \epsilon\]</span>
<span class="math display">\[log(nsin) = \beta_iX_i + log(exposicion) + \epsilon\]</span>
Esta transformación hará que los parámetros de la regresión de poisson tengan una fácil interpretación. Viendo los parámetros obtenidos con el modelo se entenderá mejor.</p>
<div class="sourceCode" id="cb446"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb446-1"><a href="modelos-GLM.html#cb446-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Edades en el conjunto de datos</span></span>
<span id="cb446-2"><a href="modelos-GLM.html#cb446-2" aria-hidden="true" tabindex="-1"></a>edades <span class="ot">&lt;-</span> moto <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(edad) <span class="sc">%&gt;%</span> <span class="fu">unique</span>()</span>
<span id="cb446-3"><a href="modelos-GLM.html#cb446-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb446-4"><a href="modelos-GLM.html#cb446-4" aria-hidden="true" tabindex="-1"></a><span class="co"># A las distintas edades se añade la frecuencia siniestral</span></span>
<span id="cb446-5"><a href="modelos-GLM.html#cb446-5" aria-hidden="true" tabindex="-1"></a>frec.siniestral <span class="ot">&lt;-</span> moto <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(edad) <span class="sc">%&gt;%</span> </span>
<span id="cb446-6"><a href="modelos-GLM.html#cb446-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">exposicion =</span> <span class="fu">sum</span>(exposicion),</span>
<span id="cb446-7"><a href="modelos-GLM.html#cb446-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">frecuencia =</span> <span class="fu">sum</span>(nsin)<span class="sc">/</span><span class="fu">sum</span>(exposicion))</span>
<span id="cb446-8"><a href="modelos-GLM.html#cb446-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb446-9"><a href="modelos-GLM.html#cb446-9" aria-hidden="true" tabindex="-1"></a>edades <span class="ot">&lt;-</span> edades <span class="sc">%&gt;%</span> <span class="fu">left_join</span>(frec.siniestral)</span>
<span id="cb446-10"><a href="modelos-GLM.html#cb446-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb446-11"><a href="modelos-GLM.html#cb446-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Se añaden los coeficientes del modelo y el exponencial de los mismos</span></span>
<span id="cb446-12"><a href="modelos-GLM.html#cb446-12" aria-hidden="true" tabindex="-1"></a>edades <span class="ot">&lt;-</span> edades <span class="sc">%&gt;%</span> </span>
<span id="cb446-13"><a href="modelos-GLM.html#cb446-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">coeficientes =</span> modelo.poisson1<span class="sc">$</span>coefficients,</span>
<span id="cb446-14"><a href="modelos-GLM.html#cb446-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">relatividad =</span> <span class="fu">exp</span>(coeficientes))</span>
<span id="cb446-15"><a href="modelos-GLM.html#cb446-15" aria-hidden="true" tabindex="-1"></a><span class="fu">datatable</span>(edades)</span></code></pre></div>
<div id="htmlwidget-5b1cddf7e92eaf8c3316" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-5b1cddf7e92eaf8c3316">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71"],[18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,92],[439.802734,342.443833,348.904093,454.649329,618.635609,831.778092,1020.328761,1136.082194,1164.45479,1146.800012,1114.79999,1089.88768,1051.849298,964.128751,886.698627,819.808215,779.054789,770.810955,729.369848,711.591776,729.172608,772.287663,977.265756,1622.630138,2401.805484,2622.523292,2651.402715,2706.304104,2747.158885,2723.073946,2744.860322,2672.295864,2643.613693,2559.471234,2423.002737,2125.506835,1895.043844,1704.728771,1467.027397,1272.468494,1029.890401,921.082179,808.4493,700.109585,578.216449,485.632884,411.358906,368.890412,326.682189,261.778082,218.832877,159.671234,117.852059,82.950687,80.498632,72.049318,46.884932,49.279456,39.879455,36.61644,28.416438,19.073973,11.627396,4.361644,8.742465,9.19726,6.304111,2.465753,1.471233,0.323288,0.386301],[0.0386536933169679,0.0146009345713637,0.028661171366654,0.0219949736250463,0.0484938137468256,0.0432807744592532,0.0401831268186706,0.0316878481065253,0.037785923831358,0.0305197066914576,0.0260136349660355,0.0229381434975024,0.0218662502734303,0.0124464704403364,0.0146611256678984,0.0146375698369893,0.0115524609142734,0.00908134472479053,0.00548418612445849,0.0070265005423559,0.00411425219088866,0.0142433972818753,0.00511631556646911,0.00554655049800388,0.00707800865359336,0.00343180936751047,0.0086746535597479,0.00480359911540821,0.00364012436797954,0.00697740875818288,0.00619339347206317,0.00449052073973498,0.00870021216068803,0.00468846839948505,0.00453982153302041,0.00470476021781412,0.00738769187020456,0.00410622506000985,0.00408990316899992,0.00550111852121032,0.00582586262982366,0.00759975619938685,0.0148432313566231,0.00142834782072009,0.00172945616080182,0.00823667451646458,0.012154835903808,0,0.00306107903544138,0.00382002951645127,0.0182787890687924,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[-3.25311295050677,-0.973556790072339,-0.299099035777983,-0.56382837280925,0.226793909721013,0.113066200063135,0.0388048481592838,-0.198709061573754,-0.0227056806161004,-0.236269732476686,-0.396021506144275,-0.52184114866672,-0.56969796374805,-1.13320524452595,-0.969442849978159,-0.971050828461866,-1.20774384803185,-1.44842004938339,-1.95277362780731,-1.70495353572916,-2.24018523846966,-0.998348877780074,-2.02220776439545,-1.94146612583912,-1.69764972394824,-2.42155469398907,-1.4942369389154,-2.08527687582273,-2.36262448038285,-1.71196471870956,-1.83115917356856,-2.15267365577666,-1.49129491682592,-2.10953636662563,-2.14175462710191,-2.10606752000657,-1.65482697380205,-2.24213819890862,-2.24612103376151,-1.94969088942037,-1.89233524903094,-1.62652616072543,-0.957098368036031,-3.29812392228368,-3.10683532730426,-1.54604564411228,-1.15691522110189,-15.7103333911949,-2.53587484870759,-2.31438417906678,-0.748901008144823,-15.6426735433127,-15.6204772965572,-15.6657368167994,-15.7019761554213,-15.5825423710334,-15.5892635824703,-15.5950993603756,-15.6143243652331,-15.7584874370729,-15.6451450743781,-15.6806146297334,-15.3489573326679,-15.693587480976,-15.6606890718233,-15.6193729246174,-15.7094758677847,-15.5343809340451,-15.6361337224754,-14.9202604269798,-15.0983337217964],[0.0386536933169825,0.377737114319969,0.741485972158495,0.569026443208921,1.25457128634921,1.11970605510665,1.0395675903245,0.819788366577955,0.977550153396706,0.789567673163488,0.672992222313922,0.593426954299151,0.565696273681304,0.321999513429961,0.379294303074034,0.378684896083669,0.298870817324988,0.234941190491692,0.141880003017703,0.18178083229297,0.106438785995177,0.368487356824427,0.132362916125868,0.143493416075912,0.183113385713278,0.0887834789645923,0.224419785416436,0.124272707293879,0.0941727440668904,0.180510791063741,0.160227728338261,0.116173135201102,0.225081005567659,0.121294189433283,0.1174485836526,0.121715670976988,0.191125122497949,0.106231118106548,0.105808858560102,0.142318056805046,0.150719430147317,0.196611385542547,0.384005513649201,0.0369524280385635,0.0447423263443345,0.213088939494628,0.314454709518558,1.50344968819436e-07,0.0791924075751136,0.0988270250173971,0.472885965097832,1.6086930958468e-07,1.64479927319986e-07,1.57201594039962e-07,1.51606702128974e-07,1.70839320047863e-07,1.69694923031382e-07,1.68707505127027e-07,1.65495080899433e-07,1.43276796598909e-07,1.60472207016388e-07,1.54880090401124e-07,2.15790602428501e-07,1.52883830615141e-07,1.57997113697555e-07,1.64661674676249e-07,1.50473948443428e-07,1.7926853960702e-07,1.61924813689538e-07,3.31293738708063e-07,2.77253462574575e-07]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>edad<\/th>\n      <th>exposicion<\/th>\n      <th>frecuencia<\/th>\n      <th>coeficientes<\/th>\n      <th>relatividad<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,2,3,4,5]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<p>Se realiza el <span class="math inline">\(exp(\beta_i)\)</span> porque hay que pasar de la estructura aditiva a la estructura multiplicativa y así facilitar la interpretación de los parámetros. De este modo, la frecuencia siniestral para los 18 años es <em>muy</em> parecido al <span class="math inline">\(exp(\beta_0)\)</span>, eso es porque es el <span class="math inline">\(\beta_0\)</span>, se recuerda, el <strong>término independiente</strong>, el nivel base. De ahí parten las estimaciones del modelo que en este caso de forma multiplicativa serían nivel base * parámetro. Ejemplo, para los 25 años la frecuencia estimada sería 0.0316873 que es la frecuencia siniestral para esa edad, la frecuencia siniestra se reduce un 18% (1-0.8197) para la edad de 18 años, está relativizando al nivel base.</p>
<p>Está sucediendo lo mismo que sucedía en la regresión logística, la estimación para una sola variable ajusta a la perfección a los datos. Evidentemente, el primer paso sería determinar que parámetros son significativos, pero el ejercicio pretende mostrar como se formula una regresión de poisson, los elementos necesarios para realizar el modelo, como estima el modelo y sobre todo <strong>como se interpretan los parámetros</strong>. Estos parámetros puestos de forma multiplicativa mediante <span class="math inline">\(exp(\beta_i)\)</span> están <strong>relativizando</strong> el nivel base, se pueden interpretar como recargos y descuentos que corrigen un nivel base y por ello son muy habituales en el mundo actuarial.</p>
<p>La modelización y los resultados son perfectamente extrapolables a la situación con más variables. Se sugiere realizar el ejercicio.</p>
</div>
<div id="los-glm-y-el-concepto-microsegmento" class="section level2 hasAnchor" number="15.5">
<h2><span class="header-section-number">15.5</span> Los GLM y el concepto microsegmento<a href="modelos-GLM.html#los-glm-y-el-concepto-microsegmento" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Este apartado del capítulo es un homenaje<a href="https://muestrear-no-es-pecado.netlify.app/2021/05/14/cosas-viejunas-o-big-data-para-pobres/" target="_blank">a esta entrada del blog de JL Cañadas</a> y sirve para entender como es la estructura que está creando un GLM y porque permite interpretar los resultados del modelo. Se ha hecho referencia a que los parámetros están creando <em>microsegmentos</em> y se ha demostrado que los modelos están ajustando a la proporción en la regresión logística y a la frecuencia en la regresión de poisson. Entonces, si el conjunto de datos está agregado por los factores que se van a emplear en la modelización y se pondera por el número de observaciones o por la exposición, ¿qué sucederá?</p>
<div class="sourceCode" id="cb447"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb447-1"><a href="modelos-GLM.html#cb447-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Se trabaja con una muestra para agilizar las ejecuciones.</span></span>
<span id="cb447-2"><a href="modelos-GLM.html#cb447-2" aria-hidden="true" tabindex="-1"></a>muestra <span class="ot">&lt;-</span> train <span class="sc">%&gt;%</span> <span class="fu">sample_frac</span>(<span class="fl">0.10</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb447-3"><a href="modelos-GLM.html#cb447-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Age =</span> <span class="fu">as.factor</span>(Age))</span>
<span id="cb447-4"><a href="modelos-GLM.html#cb447-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb447-5"><a href="modelos-GLM.html#cb447-5" aria-hidden="true" tabindex="-1"></a>modelo.sin.agregar <span class="ot">&lt;-</span> <span class="fu">glm</span>(Response <span class="sc">~</span> Age <span class="sc">+</span> Gender <span class="sc">+</span> Vehicle_Age, muestra, <span class="at">family=</span>binomial)</span>
<span id="cb447-6"><a href="modelos-GLM.html#cb447-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb447-7"><a href="modelos-GLM.html#cb447-7" aria-hidden="true" tabindex="-1"></a>agr <span class="ot">&lt;-</span> muestra <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Age, Gender, Vehicle_Age, Response) <span class="sc">%&gt;%</span> </span>
<span id="cb447-8"><a href="modelos-GLM.html#cb447-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Clientes=</span><span class="fu">n</span>())</span>
<span id="cb447-9"><a href="modelos-GLM.html#cb447-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb447-10"><a href="modelos-GLM.html#cb447-10" aria-hidden="true" tabindex="-1"></a>modelo.con.agregacion <span class="ot">=</span> <span class="fu">glm</span>(Response <span class="sc">~</span> Age <span class="sc">+</span> Gender <span class="sc">+</span> Vehicle_Age, agr, <span class="at">family=</span>binomial, </span>
<span id="cb447-11"><a href="modelos-GLM.html#cb447-11" aria-hidden="true" tabindex="-1"></a>                            <span class="at">weights =</span> Clientes)</span>
<span id="cb447-12"><a href="modelos-GLM.html#cb447-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb447-13"><a href="modelos-GLM.html#cb447-13" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">coef.sin.agregar =</span> modelo.sin.agregar<span class="sc">$</span>coefficients,</span>
<span id="cb447-14"><a href="modelos-GLM.html#cb447-14" aria-hidden="true" tabindex="-1"></a>                 <span class="at">coef.con.agregacion =</span> modelo.con.agregacion<span class="sc">$</span>coefficients)</span>
<span id="cb447-15"><a href="modelos-GLM.html#cb447-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb447-16"><a href="modelos-GLM.html#cb447-16" aria-hidden="true" tabindex="-1"></a><span class="fu">datatable</span>(df)</span></code></pre></div>
<div id="htmlwidget-bdb49eb4d25f190a26c9" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-bdb49eb4d25f190a26c9">{"x":{"filter":"none","vertical":false,"data":[["(Intercept)","Age21","Age22","Age23","Age24","Age25","Age26","Age27","Age28","Age29","Age30","Age31","Age32","Age33","Age34","Age35","Age36","Age37","Age38","Age39","Age40","Age41","Age42","Age43","Age44","Age45","Age46","Age47","Age48","Age49","Age50","Age51","Age52","Age53","Age54","Age55","Age56","Age57","Age58","Age59","Age60","Age61","Age62","Age63","Age64","Age65","Age66","Age67","Age68","Age69","Age70","Age71","Age72","Age73","Age74","Age75","Age76","Age77","Age78","Age79","Age80","Age81","Age82","Age83","Age84","Age85","GenderMale","Vehicle_Age&gt; 2 Years","Vehicle_Age1-2 Year"],[-3.92125630108948,0.566631957558031,0.634134068174664,0.643240483076129,0.359371586261314,0.487509134664777,0.264179112307959,0.352288140244605,1.05996098154029,1.40238037291165,1.46291066223451,1.69340159940787,1.70374768603898,2.05117406552286,1.45185052900164,1.45250124389253,1.18955796455431,1.3812057656405,1.38826080146823,1.20640411066809,1.57117940923291,1.19829106093034,1.054427444502,1.34313630956517,1.32002003966373,1.29851778926264,1.39714445367711,1.40741470285742,1.22065475107203,1.26037802017517,1.26926690209211,0.942836546825359,0.992865640669182,0.920537963225636,1.05585512476691,1.1690827306633,0.965935204735232,0.740543901837323,0.828414612160383,0.617195343244754,0.90216900970167,0.567660320276813,0.558788039269423,0.656012683897733,0.516908566751827,0.796164268947025,0.406854497774342,0.2906552195748,-0.236446429285829,0.211949327181506,-0.16633738595179,-0.350639209483114,-0.0465475058341647,0.197351469530549,-0.368625002909377,-0.472797924944747,0.386042847702628,-0.835380899272692,-0.251306074754445,0.641082925752416,-0.701859934918201,1.11718898015919,-10.0506662482848,-9.88006726585302,-9.8598983176643,-9.93900744419546,0.120294568183944,2.03069732276595,1.17390617214706],[-3.92125630108914,0.566631957557776,0.634134068174427,0.643240483075882,0.359371586261212,0.487509134664564,0.264179112307791,0.352288140244381,1.05996098153993,1.40238037291144,1.4629106622343,1.69340159940758,1.70374768603869,2.05117406552268,1.45185052900164,1.45250124389244,1.18955796455411,1.38120576564027,1.38826080146828,1.20640411066816,1.57117940923294,1.19829106093022,1.05442744450187,1.34313630956508,1.32002003966353,1.29851778926256,1.39714445367698,1.40741470285733,1.22065475107185,1.26037802017509,1.26926690209213,0.942836546825286,0.99286564066896,0.920537963225467,1.05585512476682,1.16908273066314,0.965935204735123,0.740543901837202,0.828414612160216,0.617195343244636,0.902169009701512,0.567660320276682,0.558788039269187,0.65601268389759,0.516908566751674,0.796164268946866,0.406854497774109,0.29065521957465,-0.236446429285964,0.211949327181345,-0.166337385951954,-0.350639209483325,-0.0465475058343349,0.197351469530335,-0.368625002909329,-0.472797924944913,0.386042847702461,-0.835380899272797,-0.251306074754622,0.641082925752258,-0.70185993491837,1.11718898015887,-10.3295474316604,-9.88003374375181,-10.0597481067167,-9.93900744420252,0.120294568183935,2.03069732276586,1.17390617214695]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>coef.sin.agregar<\/th>\n      <th>coef.con.agregacion<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,2]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<p>Los coeficientes son prácticamente los mismos pero un conjunto de datos tiene decenas de miles de observaciones y otro conjunto de datos tiene 558. Esto es porque el modelo está estimando proporciones para el cruce de factores y ese producto cartesiano de niveles de factores no deja de ser un grupo de clientes por lo que se puede modelizar el comportamiento de cada microsegmento de observaciones con las mismas características siempre y cuando se pondere por el tamaño de ese segmento. Se puede proceder del mismo modo con la regresión de poisson.</p>
<div class="sourceCode" id="cb448"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb448-1"><a href="modelos-GLM.html#cb448-1" aria-hidden="true" tabindex="-1"></a>modelo.sin.agregar <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="at">data=</span>moto, <span class="at">formula =</span> nsin <span class="sc">~</span> <span class="fu">as.factor</span>(edad) <span class="sc">+</span> sexo,</span>
<span id="cb448-2"><a href="modelos-GLM.html#cb448-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">family =</span> poisson, <span class="at">offset=</span><span class="fu">log</span>(exposicion))</span>
<span id="cb448-3"><a href="modelos-GLM.html#cb448-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb448-4"><a href="modelos-GLM.html#cb448-4" aria-hidden="true" tabindex="-1"></a>agr <span class="ot">&lt;-</span> moto <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(edad,sexo) <span class="sc">%&gt;%</span> </span>
<span id="cb448-5"><a href="modelos-GLM.html#cb448-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">nsin=</span><span class="fu">sum</span>(nsin),<span class="at">exposicion=</span><span class="fu">sum</span>(exposicion))</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;edad&#39;. You can override using the `.groups` argument.</code></pre>
<div class="sourceCode" id="cb450"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb450-1"><a href="modelos-GLM.html#cb450-1" aria-hidden="true" tabindex="-1"></a>modelo.con.agregacion <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="at">data=</span>agr, <span class="at">formula=</span>nsin <span class="sc">~</span> <span class="fu">as.factor</span>(edad) <span class="sc">+</span> sexo,</span>
<span id="cb450-2"><a href="modelos-GLM.html#cb450-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">family =</span> poisson, <span class="at">offset=</span><span class="fu">log</span>(exposicion))</span>
<span id="cb450-3"><a href="modelos-GLM.html#cb450-3" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">coef.sin.agregar =</span> modelo.sin.agregar<span class="sc">$</span>coefficients,</span>
<span id="cb450-4"><a href="modelos-GLM.html#cb450-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">coef.con.agregacion =</span> modelo.con.agregacion<span class="sc">$</span>coefficients)</span>
<span id="cb450-5"><a href="modelos-GLM.html#cb450-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb450-6"><a href="modelos-GLM.html#cb450-6" aria-hidden="true" tabindex="-1"></a><span class="fu">datatable</span>(df)</span></code></pre></div>
<div id="htmlwidget-9e42f9d5362662dc5d4a" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-9e42f9d5362662dc5d4a">{"x":{"filter":"none","vertical":false,"data":[["(Intercept)","as.factor(edad)19","as.factor(edad)20","as.factor(edad)21","as.factor(edad)22","as.factor(edad)23","as.factor(edad)24","as.factor(edad)25","as.factor(edad)26","as.factor(edad)27","as.factor(edad)28","as.factor(edad)29","as.factor(edad)30","as.factor(edad)31","as.factor(edad)32","as.factor(edad)33","as.factor(edad)34","as.factor(edad)35","as.factor(edad)36","as.factor(edad)37","as.factor(edad)38","as.factor(edad)39","as.factor(edad)40","as.factor(edad)41","as.factor(edad)42","as.factor(edad)43","as.factor(edad)44","as.factor(edad)45","as.factor(edad)46","as.factor(edad)47","as.factor(edad)48","as.factor(edad)49","as.factor(edad)50","as.factor(edad)51","as.factor(edad)52","as.factor(edad)53","as.factor(edad)54","as.factor(edad)55","as.factor(edad)56","as.factor(edad)57","as.factor(edad)58","as.factor(edad)59","as.factor(edad)60","as.factor(edad)61","as.factor(edad)62","as.factor(edad)63","as.factor(edad)64","as.factor(edad)65","as.factor(edad)66","as.factor(edad)67","as.factor(edad)68","as.factor(edad)69","as.factor(edad)70","as.factor(edad)71","as.factor(edad)72","as.factor(edad)73","as.factor(edad)74","as.factor(edad)75","as.factor(edad)76","as.factor(edad)77","as.factor(edad)78","as.factor(edad)79","as.factor(edad)80","as.factor(edad)81","as.factor(edad)82","as.factor(edad)83","as.factor(edad)84","as.factor(edad)85","as.factor(edad)86","as.factor(edad)87","as.factor(edad)92","sexoM"],[-3.6338254311352,-0.964699503183106,-0.287791219735875,-0.552801938797286,0.240793502733464,0.131294533202272,0.0652386892085189,-0.172897479502917,0.0068418561435444,-0.209989108332836,-0.363129846431966,-0.492846252113326,-0.535902038219302,-1.10656079301014,-0.940426082504012,-0.93814865016836,-1.17645476893723,-1.41572797797481,-1.91446476301658,-1.66619578375394,-2.20268153569993,-0.966566865501939,-1.99803779257757,-1.92394910452044,-1.68368382918309,-2.40798901215957,-1.4793709502355,-2.07440965586472,-2.35206994949718,-1.70411138079569,-1.82817207358948,-2.15167440389992,-1.48757763845008,-2.10665752481671,-2.1431547362396,-2.10586885106928,-1.65479021050086,-2.24424608677734,-2.25024559346935,-1.95749219105301,-1.90186110995342,-1.63631792712384,-0.96580729884642,-3.31098461684069,-3.12134489999693,-1.56050669744332,-1.17210587727074,-15.7229457252754,-2.55299610509339,-2.33015357038101,-0.768889614181936,-15.6592377019208,-15.6292645200001,-15.663576880351,-15.6898626215802,-15.5822105032127,-15.5892494322219,-15.5948734342933,-15.6133975476542,-15.7756892194994,-15.6723775745344,-15.6690006357822,-15.283794591879,-15.5820842869563,-15.6261529913448,-15.606213927109,-15.6778629224987,-15.5616134342662,-15.6633662226803,-14.9474929204443,-15.1255662217777,0.407944980825059],[-3.63382543113491,-0.964699503183225,-0.287791219736017,-0.552801938797423,0.240793502733373,0.131294533202203,0.0652386892085052,-0.172897479503116,0.00684185614344986,-0.209989108333008,-0.363129846432095,-0.492846252113471,-0.535902038219526,-1.10656079301034,-0.940426082504161,-0.938148650168466,-1.1764547689374,-1.41572797797506,-1.91446476301678,-1.66619578375419,-2.20268153570029,-0.966566865502061,-1.99803779257777,-1.92394910452068,-1.6836838291832,-2.40798901215983,-1.47937095023569,-2.07440965586498,-2.35206994949712,-1.7041113807958,-1.82817207358961,-2.15167440390021,-1.48757763845022,-2.10665752481694,-2.14315473623973,-2.10586885106953,-1.6547902105009,-2.24424608677738,-2.25024559346933,-1.95749219105315,-1.90186110995363,-1.636317927124,-0.965807298846606,-3.3109846168409,-3.12134489999713,-1.56050669744355,-1.17210587727095,-21.37373170021,-2.55299610509359,-2.33015357038114,-0.768889614182098,-20.391468707219,-20.3366146106523,-20.1946723388404,-20.2694974488018,-20.0138256132191,-19.5767515039554,-19.6224172570196,-19.4257970235847,-18.8985362859396,-20.4236724232357,-18.8120349306534,-18.5959796099082,-17.6792430302444,-18.2065547595492,-18.0969394507221,-17.8580733384224,-17.9792018801666,-17.4628054674055,-15.9474929305292,-16.1255662220378,0.407944980825089]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>coef.sin.agregar<\/th>\n      <th>coef.con.agregacion<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,2]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<p>En el caso de la regresión de poisson no es necesario emplear la ponderación porque ya está implícita en el propio offset, por lo que el código es análogo. Señalar que no se ha determinado la validez estadística de cada parámetro, no se ha estudiado el test <span class="math inline">\(\beta_i = 0\)</span> ni la prevalencia en cada uno de los niveles de los factores. Por lo que el proceso de modelización tiene que pasar previamente por un agrupamiento de variables numéricas, análisis de los factores presentes en el modelo y creación de un número de factores con los niveles adecuados para crear esos microsegmentos que permitan que los resultados sean estadísticamente correctos y que den respuesta al problema que se plantea al científico de datos. Es decir, <strong>es necesario seguir una serie de pasos para llegar a crear un modelo</strong>, la modelización estadística no es escribir unas líneas de código y que un equipo informático haga magia, requiere de un método que se tratará en el siguiente capítulo.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="introduccion-diseno-experimentos.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="modelizacion-estadistica.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rvaquerizo02/edit/master/14-Modelos-glm.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
